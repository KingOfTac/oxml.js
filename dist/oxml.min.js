!function(e,t){if("function"==typeof define&&define.amd)define([],t);else if("function"==typeof define)define(t);else if("undefined"!=typeof module&&module.exports){var r=require("jszip"),l=require("fs");module.exports=t(r,l)}else e.oxml=t()}(this,function(e,t){var r,l,n;return function(e){function t(e,t){return g.call(e,t)}function o(e,t){var r,l,n,o,s,i,a,u,f,d,c,h=t&&t.split("/"),m=v.map,p=m&&m["*"]||{};if(e){for(s=(e=e.split("/")).length-1,v.nodeIdCompat&&C.test(e[s])&&(e[s]=e[s].replace(C,"")),"."===e[0].charAt(0)&&h&&(e=h.slice(0,h.length-1).concat(e)),f=0;f<e.length;f++)if("."===(c=e[f]))e.splice(f,1),f-=1;else if(".."===c){if(0===f||1===f&&".."===e[2]||".."===e[f-1])continue;f>0&&(e.splice(f-1,2),f-=2)}e=e.join("/")}if((h||p)&&m){for(f=(r=e.split("/")).length;f>0;f-=1){if(l=r.slice(0,f).join("/"),h)for(d=h.length;d>0;d-=1)if((n=m[h.slice(0,d).join("/")])&&(n=n[l])){o=n,i=f;break}if(o)break;!a&&p&&p[l]&&(a=p[l],u=f)}!o&&a&&(o=a,i=u),o&&(r.splice(0,i,o),e=r.join("/"))}return e}function s(t,r){return function(){var l=b.call(arguments,0);return"string"!=typeof l[0]&&1===l.length&&l.push(null),c.apply(e,l.concat([t,r]))}}function i(e){return function(t){p[e]=t}}function a(r){if(t(y,r)){var l=y[r];delete y[r],_[r]=!0,d.apply(e,l)}if(!t(p,r)&&!t(_,r))throw new Error("No "+r);return p[r]}function u(e){var t,r=e?e.indexOf("!"):-1;return r>-1&&(t=e.substring(0,r),e=e.substring(r+1,e.length)),[t,e]}function f(e){return e?u(e):[]}var d,c,h,m,p={},y={},v={},_={},g=Object.prototype.hasOwnProperty,b=[].slice,C=/\.js$/;h=function(e,t){var r,l=u(e),n=l[0],s=t[1];return e=l[1],n&&(r=a(n=o(n,s))),n?e=r&&r.normalize?r.normalize(e,function(e){return function(t){return o(t,e)}}(s)):o(e,s):(n=(l=u(e=o(e,s)))[0],e=l[1],n&&(r=a(n))),{f:n?n+"!"+e:e,n:e,pr:n,p:r}},m={require:function(e){return s(e)},exports:function(e){var t=p[e];return void 0!==t?t:p[e]={}},module:function(e){return{id:e,uri:"",exports:p[e],config:function(e){return function(){return v&&v.config&&v.config[e]||{}}}(e)}}},d=function(r,l,n,o){var u,d,c,v,g,b,C,x=[],w=typeof n;if(o=o||r,b=f(o),"undefined"===w||"function"===w){for(l=!l.length&&n.length?["require","exports","module"]:l,g=0;g<l.length;g+=1)if(v=h(l[g],b),"require"===(d=v.f))x[g]=m.require(r);else if("exports"===d)x[g]=m.exports(r),C=!0;else if("module"===d)u=x[g]=m.module(r);else if(t(p,d)||t(y,d)||t(_,d))x[g]=a(d);else{if(!v.p)throw new Error(r+" missing "+d);v.p.load(v.n,s(o,!0),i(d),{}),x[g]=p[d]}c=n?n.apply(p[r],x):void 0,r&&(u&&u.exports!==e&&u.exports!==p[r]?p[r]=u.exports:c===e&&C||(p[r]=c))}else r&&(p[r]=n)},r=l=c=function(t,r,l,n,o){if("string"==typeof t)return m[t]?m[t](r):a(h(t,f(r)).f);if(!t.splice){if((v=t).deps&&c(v.deps,v.callback),!r)return;r.splice?(t=r,r=l,l=null):t=e}return r=r||function(){},"function"==typeof l&&(l=n,n=o),n?d(e,t,r,l):setTimeout(function(){d(e,t,r,l)},4),c},c.config=function(e){return c(e)},r._defined=p,(n=function(e,r,l){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");r.splice||(l=r,r=[]),t(p,e)||t(y,e)||(y[e]=[e,r,l])}).amd={jQuery:!0}}(),n("build/almond",function(){}),n("fileHandler",[],function(){"use strict";var e=function(){this.className="FileHandler"};return e.prototype=function(){var e=function(e,t){this.className="CompressedFile",this._zip=e,this._fs=t};return e.prototype=function(){return{addFile:function(e,t,r,l){var n;r&&(n=this._zip.folder(r)),l?(n||this._zip).file(t,e,l):(n||this._zip).file(t,e)},saveFile:function(e,t){var r=this._zip,l=this._fs;return"undefined"!=typeof window?r.generateAsync({type:"blob"}).then(function(l){try{if(window.saveAs)return saveAs(l,e);var n=window.URL.createObjectURL(l),o=document.createElement("a");if(o.setAttribute("href",n),o.setAttribute("download",e),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),t)t(r);else if("undefined"!=typeof Promise)return new Promise(function(e,t){e(r)})}catch(e){if(t)t(null,"Err: Not able to create file object.");else if("undefined"!=typeof Promise)return new Promise(function(e,t){t("Err: Not able to create file object.")})}}):t?(r.generateNodeStream({type:"nodebuffer",streamFiles:!0}).pipe(l.createWriteStream(e)),void t(r)):new Promise(function(t,n){r.generateNodeStream({type:"nodebuffer",streamFiles:!0}).pipe(l.createWriteStream(e)),t(r)})}}}(),{createFile:function(t,r){return new e(t,r)}}}(),e}),n("contentFile",[],function(){var e=function(e){this.className="ContentFile",this._file=e};return e.prototype=function(){return{attach:function(e){var t=this.generateContent(e);e.addFile(t,this.fileName,this.folderName),this.attachChild&&this.attachChild(e)}}}(),e}),n("contentString",[],function(){var e=function(e){e&&(this.template=e)};return e.prototype=function(){var e=function(){var e=arguments;return this.template=this.template.replace(/{(\d+)}/g,function(t,r){return void 0!==e[r]?e[r]:t}),this.template},t=function(){return this.template};return{format:e,toString:t}}(),e}),n("xmlContentString",["contentString"],function(e){var t=function(t){this.className="XMLContentString",this.rootNode=t.rootNode,this.nameSpaces=t.nameSpaces,this.template='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>';for(var r=new e("<{0}{1}{3}>{2}</{0}>"),l="",n="",o=0;o<this.nameSpaces.length;o++){var s=new e(' xmlns{0}="{1}"');"string"==typeof this.nameSpaces[o]?l+=s.format("",this.nameSpaces[o]):l+=s.format(this.nameSpaces[o].attribute?":"+this.nameSpaces[o].attribute:"",this.nameSpaces[o].value)}if(t.attributes)for(var i in t.attributes){var a=new e(' {0}="{1}"');n+=a.format(i,t.attributes[i])}this.template+=r.format(this.rootNode,l,"{0}",n)};return t.prototype=Object.create(e.prototype),t}),n("oxml_rels",["contentFile","contentString","xmlContentString"],function(e,t,r){"use strict";var l=function(e,t){this.className="Relation",this.fileName=e,this.folderName=t,this.relations=[]};return l.prototype=Object.create(e.prototype),l.prototype.addRelation=function(e,t,r){this.relations.push({Id:e,Type:t,Target:r})},l.prototype.generateContent=function(){var e,l=new r({rootNode:"Relationships",nameSpaces:["http://schemas.openxmlformats.org/package/2006/relationships"]}),n="";for(e=0;e<this.relations.length;e++){n+=new t('<Relationship Id="{0}" Type="{1}" Target="{2}"/>').format(this.relations[e].Id,this.relations[e].Type,this.relations[e].Target)}return l.format(n)},{createRelation:function(e,t){return new l(e,t)}}}),n("oxml_content_types",["contentFile","contentString","xmlContentString"],function(e,t,r){"use strict";var l=function(){this.className="ContentTypes",this._contentType={contentTypes:[]},this.fileName="[Content_Types].xml"};return l.prototype=Object.create(e.prototype),l.prototype.generateContent=function(){var e,l=new r({rootNode:"Types",nameSpaces:["http://schemas.openxmlformats.org/package/2006/content-types"]}),n="";for(e=0;e<this._contentType.contentTypes.length;e++){var o=new t('<{0} ContentType="{1}"{2}{3}/>'),s=this._contentType.contentTypes[e];n+=o.format(s.name,s.contentType,s.Extension?' Extension="'+s.Extension+'"':"",s.PartName?' PartName="'+s.PartName+'"':"")}return l.format(n)},l.prototype.addContentType=function(e,t,r){var l={name:e,contentType:t};for(var n in r)l[n]=r[n];this._contentType.contentTypes.push(l)},{createContentType:function(){return new l}}}),n("oxml_table",["xmlContentString","contentFile"],function(e,t){"use strict";var r=function(e,t,r,l,n,s,i){var a=parseInt(t.match(/\d+/)[0],10),u=parseInt(r.match(/\d+/)[0],10),f=t.match(/\D+/)[0].toUpperCase().charCodeAt()-64,d=r.match(/\D+/)[0].toUpperCase().charCodeAt()-64,c={rid:n,displayName:e,columns:l,fromCell:t,toCell:r,fromRow:a,toRow:u,fromColumn:f,toColumn:d};o(s,c,i),this.className="Table",this.fileName="table"+n+".xml",this.folderName="workbook/tables",this._table=c,this.rid=n,this._sheet=i};r.prototype=Object.create(t.prototype),r.prototype.generateContent=function(){var t=new e({rootNode:"table",nameSpaces:["http://schemas.openxmlformats.org/spreadsheetml/2006/main"],attributes:{totalsRowShown:"0",ref:this._table.fromCell+":"+this._table.toCell,displayName:this._table.displayName,name:this._table.displayName,id:this._table.rid}}),r="";if(this._table.filters){r+='<autoFilter ref="'+this._table.fromCell+":"+this._table.toCell+'">';for(var l=0;l<this._table.filters.length;l++){if(r+='<filterColumn colId="'+this._table.filters[l].column+'">',"default"===this._table.filters[l].values[0].type){r+="<filters>";for(var n=0;n<this._table.filters[l].values.length;n++)r+='<filter val="'+this._table.filters[l].values[n].value+'"/>';r+="</filters>"}else if("custom"===this._table.filters[l].values[0].type){r+='<customFilters and="'+(this._table.filters[l].values[0].and?"1":"0")+'">';for(var n=0;n<this._table.filters[l].values.length;n++)r+='<customFilter operator="'+this._table.filters[l].values[n].operator+'" val="'+this._table.filters[l].values[n].value+'"/>';r+="</customFilters>"}r+="</filterColumn>"}r+="</autoFilter>"}this._table.sort&&(r+='<sortState caseSensitive="'+(this._table.sort.caseSensitive?"1":"0")+'" ref="'+this._table.sort.dataRange+'">',r+="<sortCondition"+("ascending"===this._table.sort.direction?"":' descending="1"')+' ref="'+this._table.sort.range+'"/>',r+="</sortState>"),r+='<tableColumns count="'+this._table.columns.length+'">';for(var l=0;l<this._table.columns.length;l++)r+='<tableColumn name="'+this._table.columns[l]+'" id="'+(l+1)+'"/>';var o="";return this._table.tableStyle&&(o='<tableStyleInfo name="'+this._table.tableStyle.name+'" showColumnStripes="'+(this._table.tableStyle.showColumnStripes?"1":"0")+'" showRowStripes="'+(this._table.tableStyle.showRowStripes?"1":"0")+'" showLastColumn="'+(this._table.tableStyle.showLastColumn?"1":"0")+'" showFirstColumn="'+(this._table.tableStyle.showFirstColumn?"1":"0")+'"/>'),r+="</tableColumns>"+o,t.format(r)},r.prototype.tableOptions=function(){return a(this._table,this._sheet,this.relId)};var l=function(e,t,r){if(t.filters||(t.filters=[]),"object"==typeof e.filters&&e.filters.length)for(var l=0;l<e.filters.length;l++)if(e.filters[l].column){var n;if(e.filters[l].value)n=[],n.push({value:e.filters[l].value,type:e.filters[l].type||"default",operator:e.filters[l].operator||null,and:!1!==e.filters[l].and}),s(r,e.filters[l].column-1,[e.filters[l].value],t.fromCell,t.toCell,e.filters[l].operator);else if(e.filters[l].values&&"object"==typeof e.filters[l].values&&e.filters[l].values.length){n=[];for(var o=0;o<e.filters[l].values.length;o++)n.push({value:e.filters[l].values[o],type:e.filters[l].type||"default",operator:e.filters[l].operator||null,and:!1!==e.filters[l].and});s(r,e.filters[l].column-1,e.filters[l].values,t.fromCell,t.toCell,e.filters[l].operator)}t.filters.push({column:e.filters[l].column-1,values:n})}},n=function(e,t){var r={},l=t.fromColumn-1,n=t.toColumn-1,o=t.fromRow,s=t.toRow;"number"==typeof e.sort?(l=String.fromCharCode(e.sort+l+64),r.direction="ascending",r.caseSensitive=!0):"object"==typeof e.sort&&!e.sort.length&&e.sort.column&&(l=String.fromCharCode(e.sort.column+l+64),r.direction=e.sort.direction||"ascending",r.caseSensitive=void 0===e.sort.caseSensitive||e.sort.caseSensitive),r.range=l+(o+1)+":"+l+s,r.dataRange=String.fromCharCode(t.fromColumn+64)+(o+1)+":"+String.fromCharCode(n+65)+s,t.sort=r},o=function(e,t,r){e&&(e.filters&&l(e,t,r),e.sort&&n(e,t))},s=function(e,t,r,l,n,o){var s=parseInt(l.match(/\d+/)[0],10),i=parseInt(n.match(/\d+/)[0],10);t+=l.match(/\D+/)[0].toUpperCase().charCodeAt()-65;for(var a=s;a<i;a++){var u=!1;if(e.values[a])if(!o||"greaterThan"!==o&&"greaterThanOrEqual"!==o&&"lessThan"!==o&&"lessThanOrEqual"!==o)u="notEqual"===o?r.indexOf(e.values[a][t].value)>-1:!(r.indexOf(e.values[a][t].value)>-1);else{u=!0;for(var f=0;f<r.length;f++){switch(o){case"greaterThan":e.values[a][t].value>r[f]&&(u=!1);break;case"greaterThanOrEqual":case"lessThan":case"lessThanOrEqual":e.values[a][t].value>=r[f]&&(u=!1)}if(!u)break}}u&&(e.values[a].hidden=!0)}},i=function(e,t,r,l){var n=r._workBook.createStyles(),o=n.addTableStyle(e,t,l);l.tableStyle={name:t,showColumnStripes:!(!o.evenColumn&&!o.oddColumn),showRowStripes:!(!o.evenRow&&!o.oddRow),showLastColumn:!!o.lastColumn,showFirstColumn:!!o.firstColumn}},a=function(e,t,r){return{name:e.displayName,columns:e.columns,fromCell:e.fromCell,toCell:e.toCell,sort:e.sort,filters:e.filters,set:function(l){return o(l,e,t),a(e,t,r)},style:function(l,n){return n||(n="customTableStyle"+r),i(l,n,t,e),a(e,t,r)}}};return{addTable:function(e,t,l,n,o,s,i){return new r(e,t,l,n,o,s,i)}}}),n("oxml_sheet",["oxml_table","oxml_rels","xmlContentString","contentFile"],function(e,t,r,l){"use strict";var n=function(e,t,r,l,n){this.className="Worksheet",this.fileName="sheet"+t+".xml",this.folderName="workbook/sheets",this.xlsxContentTypes=n,this._sheet={sheetName:e,sheetId:t,rId:r,values:[],_workBook:l}};n.prototype=Object.create(l.prototype);var o=function(e,t,r,l){if(!e)return"";var n=e.styleIndex?'s="'+e.styleIndex+'"':"";if("numeric"===e.type)return'<c r="'+t+'" '+n+"><v>"+e.value+"</v></c>";if("sharedString"===e.type)return'<c r="'+t+'" t="s" '+n+"><v>"+e.value+"</v></c>";if("sharedFormula"===e.type){var o="";return e.value&&"function"==typeof e.value?o="<v>"+e.value(r+1,l+1)+"</v>":void 0!==e.value&&null!==e.value&&(o="<v>"+e.value+"</v>"),e.formula?'<c  r="'+t+'" '+n+'><f t="shared" ref="'+e.range+'" si="'+e.si+'">'+e.formula+"</f>"+o+"</c>":'<c  r="'+t+'" '+n+'><f t="shared" si="'+e.si+'"></f>'+o+"</c>"}if("string"===e.type)return'<c r="'+t+'" t="inlineStr" '+n+"><is><t>"+e.value+"</t></is></c>";if("formula"===e.type){var o="";return e.value&&"function"==typeof e.value?o="<v>"+e.value(r+1,l+1)+"</v>":void 0!==e.value&&null!==e.value&&(o="<v>"+e.value+"</v>"),'<c r="'+t+'" '+n+"><f>"+e.formula+"</f>"+o+"</c>"}},s=function(e){var t={};return e._rels.relations.length&&(t=e._rels.relations[e._rels.relations.length-1]),parseInt((t.Id||"rId0").replace("rId",""),10)+1};n.prototype.generateContent=function(e){var t=0,l="<sheetData>";if(this._sheet.values&&this._sheet.values.length)for(t=0;t<this._sheet.values.length;t++)if(this._sheet.values[t]&&this._sheet.values[t].length>0){var n=this._sheet.values[t].hidden?' hidden="1" ':"";l+='<row r="'+(t+1)+'"'+n+">";var s=0;for(s=0;s<this._sheet.values[t].length;s++){var i=String.fromCharCode(65+s),a=this._sheet.values[t][s],u=i+(t+1),f=o(a,u,t,s);l+=f}l+="</row>"}l+="</sheetData>";var d="";if(this._sheet.tables&&this._sheet.tables.length){d+='<tableParts count="'+this._sheet.tables.length+'">';for(var c=0;c<this._sheet.tables.length;c++)d+='<tablePart r:id="rId'+this._sheet.tables[c].rid+'"/>',e&&this._sheet.tables[c].attach(e);d+="</tableParts>"}return new r({rootNode:"worksheet",nameSpaces:["http://schemas.openxmlformats.org/spreadsheetml/2006/main",{value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",attribute:"r"}]}).format(l+d)},n.prototype.attachChild=function(e){this._sheet._rels&&this._sheet._rels.attach(e)};var i=function(e,t){if(void 0===e||null===e)return null;if("object"==typeof e){if(!(void 0!==e.value&&null!==e.value||e.formula&&"formula"===e.type))return null;if(e.type)return"sharedString"===e.type?"number"==typeof e.value?{type:e.type,value:e.value}:(e.value=t._workBook.createSharedString(e.value,t._workBook),{type:e.type,value:e.value}):"formula"===e.type?{type:e.type,formula:e.formula,value:e.value}:"numeric"===e.type||"string"===e.type?{type:e.type,value:e.value}:null;e=e.value}return"number"==typeof e?{type:"numeric",value:e}:"string"==typeof e?{type:"string",value:e}:null},a=function(e,t,r,l,n,o){var s,a;if(n){n.cellIndices=o;a=t._workBook.createStyles().addStyles(n)}for(s=0;s<e.length;s++)if(void 0!==e[s]||null!==e[s]){var u=s+r-1;if(t.values[u]||(t.values[u]=[]),"object"==typeof e[s]&&e[s].length>=0){var f;for(f=0;f<e[s].length;f++){var d=i(e[s][f],t);d&&(a&&(d.styleIndex=a.index),a||!t.values[u][f+l-1]?t.values[u][f+l-1]=d:(t.values[u][f+l-1].value=d.value,t.values[u][f+l-1].type=d.type))}}else{var d=i(e[s],t);d&&(a&&(d.styleIndex=a.index),a||!t.values[u][l-1]?t.values[u][l-1]=d:(t.values[u][l-1].value=d.value,t.values[u][l-1].type=d.type))}}},u=function(e,t,r,l,n){var o=String.fromCharCode(65+l-1)+r,s=r-1;if(void 0!==e&&null!==e){if(t.values[s]||(t.values[s]=[]),e=i(e,t),n){n.cellIndex=o;var a=t._workBook.createStyles();e.styleIndex=a.addStyles(n).index}e&&!e.styleIndex&&t.values[s][l-1]&&(e.styleIndex=t.values[s][l-1].styleIndex),t.values[s][l-1]=e}return f(t,o,s,l-1)},f=function(e,t,r,l){return{style:function(n){return n.cellIndex=t,c(e,n,r,l),f(e,t,r,l)},value:e.values[r]&&e.values[r][l]?e.values[r][l].value:null,type:e.values[r]&&e.values[r][l]?e.values[r][l].type:null,cellIndex:t,rowIndex:r+1,columnIndex:String.fromCharCode(65+l),formula:e.values[r]&&e.values[r][l]?e.values[r][l].formula:void 0,set:function(n,o){return m(e,r+1,l+1,n,o),this.value=e.values[r]&&e.values[r][l]?e.values[r][l].value:null,this.formula=e.values[r]&&e.values[r][l]?e.values[r][l].formula:void 0,this.type=e.values[r]&&e.values[r][l]?e.values[r][l].type:null,f(e,t,r,l)}}},d=function(e,t,r,l,n,o,s,i,a){var u,y=[];for(u=0;u<r.length;u++){var v=r[u].rowIndex,_=r[u].columnIndex,g=e.values[v]&&e.values[v][_]?e.values[v][_].value:null,b=e.values[v]&&e.values[v][_]?e.values[v][_].formula:void 0,C=e.values[v]&&e.values[v][_]?e.values[v][_].type:null,x=String.fromCharCode(65+_)+(v+1),w="sharedFormula"===C?e.values[v][_].si:void 0;y.push({style:function(t){return t.cellIndex=this.cellIndex,c(e,t,this.rowIndex-1,this.columnIndex.toUpperCase().charCodeAt()-65),f(e,this.cellIndex,this.rowIndex-1,this.columnIndex.toUpperCase().charCodeAt()-65)},rowIndex:v+1,columnIndex:String.fromCharCode(65+_),value:g,formula:b,cellIndex:x,sharedFormulaIndex:w,type:C,set:function(t,r){return m(e,v+1,_+1,t,r),this.value=e.values[v]&&e.values[v][_]?e.values[v][_].value:null,this.formula=e.values[v]&&e.values[v][_]?e.values[v][_].formula:void 0,this.type=e.values[v]&&e.values[v][_]?e.values[v][_].type:null,f(e,x,v,_)}})}return{style:function(i){return i.cellIndices=t,h(e,i,r),d(e,t,r,l,n,o,s)},cellIndices:t,cells:y,set:function(u,f){var c=[];if(!(u&&u.length&&s&&o))return d(e,t,r,l,n,o,s);if(i||a)for(var h=0;h<this.cells.length&&h<u.length;h++)c.push(u[h]);if(i)u=[c];else if(a)u=c;else{for(var c=[],h=0;h<u.length&&h<o;h++)if(u[h]){var m=[];if(u[h].length>s){for(var y=0;y<u[h].length&&y<s;y++)m.push(u[h][y]);u[h]=m}c.push(u[h])}else c.push([]);u=c}p(e,l,n,o,s,u,f,!1,i,a);var v=d(e,t,r,l,n,o,s);return this.cells=v.cells,v}}},c=function(e,t,r,l){var n=e._workBook.createStyles(),o=n.addStyles(t).index;e.values[r]||(e.values[r]=[]),e.values[r][l]||(e.values[r][l]={value:"",type:"string"}),e.values[r][l].styleIndex=o},h=function(e,t,r){for(var l=e._workBook.createStyles(),n=l.addStyles(t).index,o=0;o<r.length;o++)e.values[r[o].rowIndex]||(e.values[r[o].rowIndex]=[]),e.values[r[o].rowIndex][r[o].columnIndex]||(e.values[r[o].rowIndex][r[o].columnIndex]={type:"string",value:""}),e.values[r[o].rowIndex][r[o].columnIndex].styleIndex=n};n.prototype.sharedFormula=function(e,t,r,l){var n,o=[],s=[];if(e&&r&&t){var i;if("object"==typeof r&&!r.length){if(!r.formula)return;i=r.value,r=r.formula}var a=e.match(/\D+/)[0],u=e.match(/\d+/)[0];if(this._sheet._sharedFormula){n=this._sheet._sharedFormula[this._sheet._sharedFormula.length-1].si+1}else this._sheet._sharedFormula=[],n=0;this._sheet._sharedFormula.push({si:n,fromCell:e,toCell:t,formula:r});var f=a.toUpperCase().charCodeAt()-65,c=parseInt(u,10);this._sheet.values[c-1]||(this._sheet.values[c-1]=[]),this._sheet.values[c-1][f]={type:"sharedFormula",si:n,formula:r,range:e+":"+t,value:i},o.push(String.fromCharCode(65+f)+c),s.push({rowIndex:c-1,columnIndex:f});var h,m;if(t&&(h=t.match(/\D+/)[0],m=t.match(/\d+/)[0]),m===u){var p=h.toUpperCase().charCodeAt()-65;for(f++;f<=p;f++)this._sheet.values[c-1][f]={type:"sharedFormula",si:n,value:i},o.push(String.fromCharCode(65+f)+c),s.push({rowIndex:c-1,columnIndex:f})}else if(h===a){var y=parseInt(m,10);for(c++;c<=y;c++)this._sheet.values[c-1]||(this._sheet.values[c-1]=[]),o.push(String.fromCharCode(65+f)+c),s.push({rowIndex:c-1,columnIndex:f}),this._sheet.values[c-1][f]={type:"sharedFormula",si:n,value:i}}if(l){l.cellIndices=o;var v;v=this._sheet._workBook.createStyles().addStyles(l);for(var _=0;_<s.length;_++)this._sheet.values[s[_].rowIndex][s[_].columnIndex].styleIndex=v.index}return d(this._sheet,o,s)}};var m=function(e,t,r,l,n){if(t&&r&&"number"==typeof t&&"number"==typeof r){if(n||void 0!==l&&null!==l)return n||"object"!=typeof l||l.type||void 0!==l.value&&null!==l.value?void 0===l||null===l?y(e,t,r,n):u(l,e,t,r,n):y(e,t,r,l);var o=String.fromCharCode(65+r-1)+t;return f(e,o,t-1,r-1)}};n.prototype.cell=function(e,t,r,l){return m(this._sheet,e,t,r,l)},n.prototype.row=function(e,t,r,l){var n=this._sheet.values[e-1]?this._sheet.values[e-1].length-t+1:0;return p(this._sheet,e,t,1,r&&Array.isArray(r)?r.length:r?1:n,r?[r]:null,l,!0,!0,!1)},n.prototype.column=function(e,t,r,l){var n=0;return r&&r.length||(n=this._sheet.values&&this._sheet.values.length&&this._sheet.values.length>e?this._sheet.values.length-e+1:0),p(this._sheet,e,t,r&&Array.isArray(r)?r.length:r?1:n,1,r,l,!0,!1,!0)},n.prototype.grid=function(e,t,r,l){var n,o=0,s=0;if(r&&r.length)for(o=r.length,n=0;n<r.length;n++)r[n]&&r[n].length&&(s=s<r[n].length?r[n].length:s);else if(this._sheet.values&&this._sheet.values.length){o=this._sheet.values.length-e+1;for(var n=0;n<this._sheet.values.length;n++)this._sheet.values[n]&&this._sheet.values[n].length&&(s=s<this._sheet.values[n].length-t+1?this._sheet.values[n].length-t+1:s)}return p(this._sheet,e,t,o,s,r,l,!0,!1)},n.prototype.table=function(e,t,r,l){var n=v(this._sheet,this.xlsxContentTypes,e,t,r,l);return n?n.tableOptions():void 0};var p=function(e,t,r,l,n,o,s,i,u,f){if(t&&r&&"number"==typeof t&&"number"==typeof r&&"number"==typeof l&&"number"==typeof n){for(var c=[],m=[],p=l,y=t-1;p>0;y++,p--){var v=n;e.values[y]||(e.values[y]=[]);for(var _=r-1;v>0;_++,v--)m.push(String.fromCharCode(65+_)+(y+1)),c.push({rowIndex:y,columnIndex:_})}if(s||o){if(void 0===o||null===o){if(s.cellIndices=m,h(e,s,c),!i)return;return d(e,m,c,t,r,l,n,u,f)}if(a(o,e,t,r,s,m),!i)return;return d(e,m,c,t,r,l,n,u,f)}return d(e,m,c,t,r,l,n,u,f)}},y=function(e,t,r,l){var n=String.fromCharCode(65+r-1)+t;return l.cellIndex=n,c(e,l,t-1,r-1),f(e,n,t-1,r-1)},v=function(t,r,l,n,o,s){var i=[],a=n.match(/\D+/)[0].toUpperCase().charCodeAt()-65,u=parseInt(n.match(/\d+/)[0],10),f=o.match(/\D+/)[0].toUpperCase().charCodeAt()-65,d=t.values[u-1];if(d){for(var c=a;c<=f;c++)i.push(d[c]&&d[c].value?d[c].value:"");var h=_("table",r,t);t.tables||(t.tables=[]);var m=e.addTable(l,n,o,i,h,s,t);return t.tables.push(m),m}},_=function(e,r,l){l._rels||(l._rels=t.createRelation("sheet"+l.sheetId+".xml.rels","workbook/sheets/_rels"));var n,o,i,a,u=s(l);switch(e){case"table":n="http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",o="../tables/table"+u+".xml",i="application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml",a="/workbook/tables/table"+u+".xml";break;case"drawing":n="http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",o="../drawings/drawing"+u+".xml",i="application/vnd.openxmlformats-officedocument.drawing+xml",a="/workbook/drawings/drawing"+u+".xml"}return l._rels.addRelation("rId"+u,n,o),r.addContentType("Override",i,{PartName:a}),u};return{createSheet:function(e,t,r,l,o){return new n(e,t,r,l,o)}}}),n("utils",[],function(){return sortObject=function(e){if("object"!=typeof e||e.length)return e;var t={},r=[];for(var l in e)r.push(l);r.sort();for(var n in r)t[r[n]]=sortObject(e[r[n]]);return t},{stringify:function(e){return JSON.stringify(sortObject(e))}}}),n("oxml_xlsx_font",["utils"],function(e){var t=function(e){var t,l="";l+='<fonts count="'+e._fontsCount+'">';for(t in e._fonts){var n=JSON.parse(t);l+=r(n)}return l+="</fonts>"},r=function(e){var t="<font>";return t+=e.strike?"<strike/>":"",t+=e.italic?"<i/>":"",t+=e.bold?"<b/>":"",t+=e.underline?"<u/>":"",t+=e.size?'<sz val="'+e.size+'"/>':"",t+=e.color?'<color rgb="'+e.color+'"/>':"",t+=e.name?'<name val="'+e.name+'"/>':"",t+=e.family?'<family val="'+e.family+'"/>':"",t+=e.scheme?'<scheme val="'+e.scheme+'"/>':"",t+="</font>"},l=function(e){var t={};return t.bold=!!e.bold,t.italic=!!e.italic,t.underline=!!e.underline,t.size=e.fontSize||!1,t.color=e.fontColor||!1,t.name=e.fontName||!1,t.family=e.fontFamily||!1,t.scheme=e.scheme||!1,t.strike=!!e.strike,t},n=function(t,r){return r._fonts[e.stringify(t)]},o=function(e,t){for(var r,l=0,n=0,o=0;o<t.length;o++)for(var s=t[0];l<e.styles.length;l++)if((void 0!==e.styles[l].cellIndices[s]||null!==e.styles[l].cellIndices[s])&&(r=e.styles[l],n++,Object.keys(r.cellIndices).length!==t.length||n>1||0===r._font))return!1;return!!r&&r._font},s=function(t,r){var l=r._fontsCount++;return r._fonts[e.stringify(t)]=""+l,r._fonts[e.stringify(t)]},i=function(t,r,l){return u(t,r,l,!0),l._fonts[e.stringify(t)]=r,r},a=function(e,t){var r=l(e);if(t){for(var n in r)r[n]&&(t[n]=r[n]);return t}return r},u=function(t,r,l,n){var o;for(var s in l._fonts)if(l._fonts[s]===r){o=JSON.parse(s);break}n&&delete l._fonts[e.stringify(o)];for(var s in t)t[s]&&(o[s]=t[s]),t[s]=o[s];return t},f=function(e,t){var r,l=0;for(r=0;r<t.styles.length;r++)if(t.styles[r]._font===e&&(l+=Object.keys(t.styles[r].cellIndices).length)>1)return l;return l},d=function(e,t){var r,a=!1,u=l(t),f=e._fonts?n(u,e):null;return void 0!==f&&null!==f?r=f:a=!0,r||!1!==(f=o(e,t.cellIndices))&&(r=i(u,f,e)),void 0!==r&&null!==r||(r=s(u,e)),{font:u,fontIndex:r,newStyleCreated:a}};return{createTableFont:a,getFontForCell:function(e,t,r){var o,a=!1,d=l(t),c=e._fonts?n(d,e):null;if(void 0!==c&&null!==c?o=c:a=!0,r&&r._font){f(r._font,e)<=1?o=i(d,r._font,e):(d=u(d,r._font,e),c=n(d,e),void 0!==c&&null!==c?o=c:(o=null,a=!0))}return void 0!==o&&null!==o||(o=s(d,e)),{font:d,fontIndex:o,newStyleCreated:a}},getFontForCells:d,generateContent:t,generateSingleContent:r}}),n("oxml_xlsx_num_format",["utils"],function(e){var t=function(e){var t="";if(e._numFormats){t+='<numFmts count="'+Object.keys(e._numFormats).length+'">';var r;for(r in e._numFormats){var l=JSON.parse(r);t+='<numFmt numFmtId="'+e._numFormats[r]+'" formatCode="'+l.formatString+'"/>'}t+="</numFmts>"}return t},r=function(e){var t={};return t.formatString=e.numberFormat,t},l=function(t,r){return r._numFormats[e.stringify(t)]},n=function(t,r){r._numFormats||(r._numFormats={},r._numFormatsCount=200);var l=r._numFormatsCount++;return r._numFormats[e.stringify(t)]=""+l,r._numFormats[e.stringify(t)]},o=function(t,r,l){var n;for(var o in l._numFormats)if(l._numFormats[o]===r){n=JSON.parse(o);break}return t.formatString?(delete l._numFormats[e.stringify(n)],l._numFormats[e.stringify(t)]=r):t.formatString=n.formatString,r},s=function(e,t){var r,l=0;for(r=0;r<t.styles.length;r++)if(t.styles[r]._numFormat===e&&(l+=Object.keys(t.styles[r].cellIndices).length)>1)return l;return l},i=function(e,t){for(var r,l=0,n=0,o=0;o<t.length;o++)for(var s=t[0];l<e.styles.length;l++)if((void 0!==e.styles[l].cellIndices[s]||null!==e.styles[l].cellIndices[s])&&(r=e.styles[l],n++,Object.keys(r.cellIndices).length!==t.length||n>1))return!1;return!!r&&r._numFormat},a=function(e,t){var s,a=!1,u=r(t),f=e._numFormats?l(u,e):null;return void 0!==f&&null!==f?s=f:u.formatString&&(a=!0),s||!1!==(f=i(e,t.cellIndices))&&(s=o(u,f,e)),void 0!==s&&null!==s||!u.formatString||(s=n(u,e)),{numFormat:u,numFormatIndex:s||!1,newStyleCreated:a}};return{generateContent:t,getNumFormatForCell:function(e,t,i){var a,u=!1,f=r(t),d=e._numFormats?l(f,e):null;if(void 0!==d&&null!==d?a=d:f.formatString&&(u=!0),i&&i._numFormat){s(i._numFormat,e)<=1&&e._numFormats&&(a=o(f,i._numFormat,e))}return void 0!==a&&null!==a||!f.formatString||(a=n(f,e)),{numFormat:f,numFormatIndex:a||!1,newStyleCreated:u}},getNumFormatForCells:a}}),n("oxml_xlsx_border",["utils"],function(e){var t=function(e,t){if(e.style||e.color){return"<"+t+(e.style?' style="'+e.style+'"':"")+">"+(e.color?'<color rgb="'+e.color+'"/>':"")+"</"+t+">"}return"<"+t+"/>"},r=function(e){var t,r="";r+='<borders count="'+e._bordersCount+'">';for(t in e._borders){var n=JSON.parse(t);r+=n?l(n):"<border />"}return r+="</borders>"},l=function(e){var r="<border>";return r+=t(e.left,"left"),r+=t(e.right,"right"),r+=t(e.top,"top"),r+=t(e.bottom,"bottom"),r+=t(e.diagonal,"diagonal"),r+="</border>"},n=function(e){var t={};return!!e.border&&(t.left={color:!!e.border.left&&e.border.left.color||e.border.color||!1,style:!!e.border.left&&e.border.left.style||e.border.style||!1},t.top={color:!!e.border.top&&e.border.top.color||e.border.color||!1,style:!!e.border.top&&e.border.top.style||e.border.style||!1},t.bottom={color:!!e.border.bottom&&e.border.bottom.color||e.border.color||!1,style:!!e.border.bottom&&e.border.bottom.style||e.border.style||!1},t.right={color:!!e.border.right&&e.border.right.color||e.border.color||!1,style:!!e.border.right&&e.border.right.style||e.border.style||!1},t.diagonal={color:!!e.border.diagonal&&e.border.diagonal.color||e.border.color||!1,style:!!e.border.diagonal&&e.border.diagonal.style||e.border.style||!1},t.isValid=t.left.style||t.top.style||t.bottom.style||t.right.style||t.diagonal.style||t.left.color||t.top.color||t.bottom.color||t.right.color||t.diagonal.color,!!t.isValid&&t)},o=function(t,r){return r._borders[e.stringify(t)]},s=function(t,r){var l=r._bordersCount++;return r._borders[e.stringify(t)]=""+l,r._borders[e.stringify(t)]},i=function(e,t){for(var r,l=0,n=0,o=0;o<t.length;o++)for(var s=t[0];l<e.styles.length;l++)if((void 0!==e.styles[l].cellIndices[s]||null!==e.styles[l].cellIndices[s])&&(r=e.styles[l],n++,Object.keys(r.cellIndices).length!==t.length||n>1||0===r._border))return!1;return!!r&&r._border},a=function(t,r,l){return f(t,r,l,!0),l._borders[e.stringify(t)]=r,r},u=function(e,t){var r=n(e);if(t){for(var l in r)r[l]&&(r[l].color||r[l].style)&&(t[l]=r[l]);return t}return r},f=function(t,r,l,n){var o;for(var s in l._borders)if(l._borders[s]===r){o=JSON.parse(s);break}if(n&&delete l._borders[e.stringify(o)],t)for(var s in t)(t[s].color||t[s].style)&&(o[s]=t[s]),t[s]=o[s];else t=o;return t},d=function(e,t){var r,l=0;for(r=0;r<t.styles.length;r++)if(t.styles[r]._border===e&&(l+=Object.keys(t.styles[r].cellIndices).length)>1)return l;return l};return{createTableBorder:u,getBorderForCell:function(e,t,r){var l,i=!1,u=n(t),c=e._borders?o(u,e):null;if(void 0!==c&&null!==c?l=c:i=!0,r&&r._border&&r._border!==c){d(r._border,e)<=1&&(l=a(u,r._border,e))}return void 0!==l&&null!==l||(r&&r._border&&(u=f(u,r._border,e,!1)),l=s(u,e)),{border:u,borderIndex:l,newStyleCreated:i}},getBorderForCells:function(e,t){var r,l=!1,u=n(t),f=e._borders?o(u,e):null;return void 0!==f&&null!==f?r=f:l=!0,f=i(e,t.cellIndices),!1!==f&&(r=a(u,f,e)),void 0!==r&&null!==r||(r=s(u,e)),{border:u,borderIndex:r,newStyleCreated:l}},generateContent:r,generateSingleContent:l}}),n("oxml_xlsx_fill",["utils"],function(e){var t=function(e){var t,l="";l+='<fills count="'+e._fillsCount+'">';for(t in e._fills){var n=JSON.parse(t);l+=n?r(n):"<fill/>"}return l+="</fills>"},r=function(e){var t="<fill>";if(e.pattern){var r=e.pattern||"none",l=e.fgColor?'<fgColor rgb="'+e.fgColor+'"/>':"";l+=e.bgColor?'<bgColor rgb="'+e.bgColor+'"/>':"",t+='<patternFill patternType="'+r+'">'+l+"</patternFill>"}else if(e.gradient){var n=e.gradient.type?' type="'+e.gradient.type+'"':"",o=e.gradient.left?' left="'+e.gradient.left+'"':"",s=e.gradient.right?' right="'+e.gradient.right+'"':"",i=e.gradient.top?' top="'+e.gradient.top+'"':"",a=e.gradient.bottom?' bottom="'+e.gradient.bottom+'"':"",u=e.gradient.degree?' degree="'+e.gradient.degree+'"':"";t+="<gradientFill"+n+o+s+i+a+u+">";for(var f=0;f<e.gradient.stops.length;f++)t+='<stop position="'+e.gradient.stops[f].position+'">',t+='<color rgb="'+e.gradient.stops[f].color+'"/></stop>';t+="</gradientFill>"}return t+"</fill>"},l=function(e){if(e.fill&&e.fill.pattern){var t={};return t.pattern=e.fill.pattern,
t.fgColor=e.fill.foreColor||!1,t.bgColor=e.fill.backColor||e.fill.color||!1,t}if(e.fill&&e.fill.gradient&&e.fill.gradient.stops){var t={};t.gradient={},t.gradient.degree=e.fill.gradient.degree||!1,t.gradient.bottom=e.fill.gradient.bottom||!1,t.gradient.left=e.fill.gradient.left||!1,t.gradient.right=e.fill.gradient.right||!1,t.gradient.top=e.fill.gradient.top||!1,t.gradient.type=e.fill.gradient.type||!1,t.gradient.stops=[];for(var r=0;r<e.fill.gradient.stops.length;r++){var l={};l.position=e.fill.gradient.stops[r].position||0,l.color=e.fill.gradient.stops[r].color||!1,t.gradient.stops.push(l)}return t}return!1},n=function(t,r){return r._fills[e.stringify(t)]},o=function(t,r){var l=r._fillsCount++;return r._fills[e.stringify(t)]=""+l,r._fills[e.stringify(t)]},s=function(e,t){for(var r,l=0,n=0,o=0;o<t.length;o++)for(var s=t[0];l<e.styles.length;l++)if((void 0!==e.styles[l].cellIndices[s]||null!==e.styles[l].cellIndices[s])&&(r=e.styles[l],n++,Object.keys(r.cellIndices).length!==t.length||n>1||0===r._fill))return!1;return!!r&&r._fill},i=function(t,r,l){return u(t,r,l,!0),l._fills[e.stringify(t)]=r,r},a=function(e,t){return l(e)||t||!1},u=function(t,r,l,n){var o;for(var s in l._fills)if(l._fills[s]===r){o=JSON.parse(s);break}n&&delete l._fills[e.stringify(o)];for(var s in t)t[s]&&(o[s]=t[s]),t[s]=o[s];return t},f=function(e,t){var r,a=!1,u=l(t),f=e._fills?n(u,e):null;return void 0!==f&&null!==f?r=f:a=!0,r||!1!==(f=s(e,t.cellIndices))&&(r=i(u,f,e)),void 0!==r&&null!==r||(r=o(u,e)),{fill:u,fillIndex:r,newStyleCreated:a}},d=function(e,t){var r,l=0;for(r=0;r<t.styles.length;r++)if(t.styles[r]._fill===e&&(l+=Object.keys(t.styles[r].cellIndices).length)>1)return l;return l};return{createTableFill:a,generateContent:t,getFillForCell:function(e,t,r){var s,a=!1,f=l(t),c=e._fills?n(f,e):null;if(void 0!==c&&null!==c?s=c:a=!0,r&&r._fill&&f){d(r._fill,e)<=1&&(s=i(f,r._fill,e))}return void 0!==s&&null!==s||(r&&r._fill&&(f=u(f,r._fill,e,!1)),s=o(f,e)),!s&&r&&r._fill&&(s=r._fill),{fill:f,fillIndex:s,newStyleCreated:a}},getFillForCells:f,generateSingleContent:r}}),n("oxml_xlsx_styles",["utils","oxml_xlsx_font","oxml_xlsx_num_format","oxml_xlsx_border","oxml_xlsx_fill","xmlContentString","contentString","contentFile"],function(e,t,r,l,n,o,s,i){"use strict";var a=function(t,r,l){var n=d(t,r,l),o={sheetId:n,fileName:"style"+n+".xml",styles:[],_fonts:{},_borders:{},_fills:{},_fontsCount:1,_bordersCount:1,_fillsCount:2},s={bold:!1,italic:!1,underline:!1,size:!1,color:!1,strike:!1,family:!1,name:!1,scheme:!1};o._fonts[e.stringify(s)]=0,o._borders[!1]=0,o._fills[!1]=0;var i={pattern:"gray125",fgColor:!1,bgColor:!1};o._fills[e.stringify(i)]=1,this.className="Style",this.fileName=o.fileName,this.folderName="workbook",this._styles=o};a.prototype=Object.create(i.prototype),a.prototype.generateContent=function(){var e=new o({rootNode:"styleSheet",nameSpaces:["http://schemas.openxmlformats.org/spreadsheetml/2006/main"]}),s="",i=0;for(s+=r.generateContent(this._styles),s+=t.generateContent(this._styles),s+=n.generateContent(this._styles),s+=l.generateContent(this._styles),s+='<cellStyleXfs count="1"><xf /></cellStyleXfs>',s+='<cellXfs count="'+(parseInt(this._styles.styles.length,10)+1)+'"><xf />',i=0;i<this._styles.styles.length;i++){var a=this._styles.styles[i]._numFormat?' numFmtId="'+this._styles.styles[i]._numFormat+'" ':"",f=this._styles.styles[i]._border?' borderId="'+this._styles.styles[i]._border+'" ':"",d=this._styles.styles[i]._fill?' fillId="'+this._styles.styles[i]._fill+'" ':"";s+='<xf fontId="'+this._styles.styles[i]._font+'" '+a+f+d+" />"}var c="";return this._styles.tableStyles&&this._styles.tableStyles.length&&(c=u(this._styles)),s+="</cellXfs>"+c,e.format(s)};var u=function(e){for(var t,r=0,l="",n=0,o="",s=0;s<e.tableStyles.length;s++){var i;r++,n++,t=1,o+=f(e.tableStyles[s]),i='<tableStyleElement dxfId="'+(r-1)+'" type="wholeTable"/>',e.tableStyles[s].evenColumn&&(r++,t++,i+='<tableStyleElement dxfId="'+(r-1)+'" type="secondColumnStripe"/>',o+=f(e.tableStyles[s].evenColumn)),e.tableStyles[s].oddColumn&&(r++,t++,i+='<tableStyleElement dxfId="'+(r-1)+'" type="firstColumnStripe"/>',o+=f(e.tableStyles[s].oddColumn)),e.tableStyles[s].evenRow&&(r++,t++,i+='<tableStyleElement dxfId="'+(r-1)+'" type="secondRowStripe"/>',o+=f(e.tableStyles[s].evenRow)),e.tableStyles[s].oddRow&&(r++,t++,i+='<tableStyleElement dxfId="'+(r-1)+'" type="firstRowStripe"/>',o+=f(e.tableStyles[s].oddRow)),e.tableStyles[s].firstColumn&&(r++,t++,i+='<tableStyleElement dxfId="'+(r-1)+'" type="firstColumn"/>',o+=f(e.tableStyles[s].firstColumn)),e.tableStyles[s].lastColumn&&(r++,t++,i+='<tableStyleElement dxfId="'+(r-1)+'" type="lastColumn"/>',o+=f(e.tableStyles[s].lastColumn)),e.tableStyles[s].firstRow&&(r++,t++,i+='<tableStyleElement dxfId="'+(r-1)+'" type="headerRow"/>',o+=f(e.tableStyles[s].firstRow)),e.tableStyles[s].lastRow&&(r++,t++,i+='<tableStyleElement dxfId="'+(r-1)+'" type="totalRow"/>',o+=f(e.tableStyles[s].lastRow)),e.tableStyles[s].firstRowFirstCell&&(r++,t++,i+='<tableStyleElement dxfId="'+(r-1)+'" type="firstHeaderCell"/>',o+=f(e.tableStyles[s].firstRowFirstCell)),e.tableStyles[s].firstRowLastCell&&(r++,t++,i+='<tableStyleElement dxfId="'+(r-1)+'" type="lastHeaderCell"/>',o+=f(e.tableStyles[s].firstRowLastCell)),e.tableStyles[s].lastRowFirstCell&&(r++,t++,i+='<tableStyleElement dxfId="'+(r-1)+'" type="firstTotalCell"/>',o+=f(e.tableStyles[s].lastRowFirstCell)),e.tableStyles[s].lastRowLastCell&&(r++,t++,i+='<tableStyleElement dxfId="'+(r-1)+'" type="lastTotalCell"/>',o+=f(e.tableStyles[s].lastRowLastCell)),l+='<tableStyle count="'+t+'" name="'+e.tableStyles[s].name+'">'+i+"</tableStyle>"}return l='<tableStyles count="'+n+'">'+l+"</tableStyles>",o='<dxfs count="'+r+'">'+o+"</dxfs>"+l},f=function(e){var r="<dxf>";return e.font&&(r+=t.generateSingleContent(e.font)),e.fill&&(r+=n.generateSingleContent(e.fill)),e.border&&(r+=l.generateSingleContent(e.border)),r+="</dxf>"},d=function(e,t,r){var l=e.getLastSheet(),n=parseInt((l.Id||"rId0").replace("rId",""),10)+1;return r.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",{PartName:"/workbook/style"+n+".xml"}),t.addRelation("rId"+n,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","style"+n+".xml"),n},c=function(e,t){for(var r=0;r<e.styles.length;r++)if(void 0!==e.styles[r].cellIndices[t]&&null!==e.styles[r].cellIndices[t])return e.styles[r];return null},h=function(e,t){for(var r=0;r<e.styles.length;r++)if(e.styles[r]._font===t._font&&e.styles[r]._numFormat===t._numFormat)return e.styles[r];return null};a.prototype.addStyles=function(e){if(e.cellIndex||e.cellIndices){var o,s,i,a,u,f=!1;if(e.cellIndex){if(o=c(this._styles,e.cellIndex),s=t.getFontForCell(this._styles,e,o),i=r.getNumFormatForCell(this._styles,e,o),a=l.getBorderForCell(this._styles,e,o),u=n.getFillForCell(this._styles,e,o),f=f||s.newStyleCreated||a.newStyleCreated||u.newStyleCreated,o){if(o._font===s.fontIndex&&o._numFormat===i.numFormatIndex&&o._border===a.borderIndex&&o._fill===u.fillIndex)return o;if(1===Object.keys(o.cellIndices).length)return o._font=s.fontIndex,o._numFormat=i.numFormatIndex,o._border=a.borderIndex,o._fill=u.fillIndex,o;delete o.cellIndices[e.cellIndex]}return!f&&(o=h(this._styles,{_font:s.fontIndex,_numFormat:i.numFormatIndex,_border:a.borderIndex,_fill:u.fillIndex}))?(o.cellIndices[e.cellIndex]=Object.keys(o.cellIndices).length,o):(o={_font:s.fontIndex,_numFormat:i.numFormatIndex||!1,_border:a.borderIndex,_fill:u.fillIndex,cellIndices:{}},o.cellIndices[e.cellIndex]=0,o.index=""+(parseInt(this._styles.styles.length,10)+1),this._styles.styles.push(o),o)}if(e.cellIndices){var d;if(s=t.getFontForCells(this._styles,e),i=r.getNumFormatForCells(this._styles,e),a=l.getBorderForCells(this._styles,e),u=n.getFillForCells(this._styles,e),!(f=f||s.newStyleCreated||i.newStyleCreated||a.newStyleCreated||u.newStyleCreated)&&(o=h(this._styles,{_font:s.fontIndex,_numFormat:i.numFormatIndex,_border:a.borderIndex,_fill:u.fillIndex}))){for(d=0;d<e.cellIndices.length;d++){var m=e.cellIndices[d],p=c(this._styles,m);p&&delete p.cellIndices[m],o.cellIndices[m]=Object.keys(o.cellIndices).length}return o}for(o={_font:s.fontIndex,_numFormat:i.numFormatIndex,_border:a.borderIndex,_fill:u.fillIndex,cellIndices:{}},d=0;d<e.cellIndices.length;d++){var m=e.cellIndices[d],p=c(this._styles,m);if(p&&delete p.cellIndices[m],o.cellIndices[m]=Object.keys(o.cellIndices).length,p&&!Object.keys(p.cellIndices).length){for(var y in o)p[y]=o[y];return p}}return o.index=""+(parseInt(this._styles.styles.length,10)+1),this._styles.styles.push(o),o}}},a.prototype.addTableStyle=function(e,t,r){this._styles.tableStyles||(this._styles.tableStyles=[]);var l;if(r&&r.tableStyle)for(var n=0;n<this._styles.tableStyles.length;n++)if(r.tableStyle.name===this._styles.tableStyles[n].name){l=this._styles.tableStyles[n];break}var o=m(e,l);if(o.name=t,e.evenColumn?o.evenColumn=m(e.evenColumn,l&&l.evenColumn):l&&l.evenColumn&&(o.evenColumn=l.evenColumn),e.oddColumn?o.oddColumn=m(e.oddColumn,l&&l.oddColumn):l&&l.oddColumn&&(o.oddColumn=l.oddColumn),e.evenRow?o.evenRow=m(e.evenRow,l&&l.evenRow):l&&l.evenRow&&(o.evenRow=l.evenRow),e.oddRow?o.oddRow=m(e.oddRow,l&&l.oddRow):l&&l.oddRow&&(o.oddRow=l.oddRow),e.firstColumn?o.firstColumn=m(e.firstColumn,l&&l.firstColumn):l&&l.firstColumn&&(o.firstColumn=l.firstColumn),e.lastColumn?o.lastColumn=m(e.lastColumn,l&&l.lastColumn):l&&l.lastColumn&&(o.lastColumn=l.lastColumn),e.firstRow?o.firstRow=m(e.firstRow,l&&l.firstRow):l&&l.firstRow&&(o.firstRow=l.firstRow),e.lastRow?o.lastRow=m(e.lastRow,l&&l.lastRow):l&&l.lastRow&&(o.lastRow=l.lastRow),e.firstRowFirstCell?o.firstRowFirstCell=m(e.firstRowFirstCell,l&&l.firstRowFirstCell):l&&l.firstRowFirstCell&&(o.firstRowFirstCell=l.firstRowFirstCell),e.firstRowLastCell?o.firstRowLastCell=m(e.firstRowLastCell,l&&l.firstRowLastCell):l&&l.firstRowLastCell&&(o.firstRowLastCell=l.firstRowLastCell),e.lastRowFirstCell?o.lastRowFirstCell=m(e.lastRowFirstCell,l&&l.lastRowFirstCell):l&&l.lastRowFirstCell&&(o.lastRowFirstCell=l.lastRowFirstCell),e.lastRowLastCell?o.lastRowLastCell=m(e.lastRowLastCell,l&&l.lastRowLastCell):l&&l.lastRowLastCell&&(o.lastRowLastCell=l.lastRowLastCell),l){for(var n=0;n<this._styles.tableStyles.length;n++)if(r.tableStyle.name===this._styles.tableStyles[n].name){this._styles.tableStyles[n]=o;break}}else this._styles.tableStyles.push(o);return o};var m=function(e,r){var o={};return o.font=t.createTableFont(e,r?r.font:null),o.fill=n.createTableFill(e,r?r.fill:null),o.border=l.createTableBorder(e),o};return{createStyle:function(e,t,r){return new a(e,t,r)}}}),n("oxml_workbook",["oxml_rels","oxml_sheet","oxml_xlsx_styles","xmlContentString","contentString","contentFile"],function(e,t,r,l,n,o){"use strict";var s=function(t,r){this.className="Workbook",this.fileName="workbook.xml",this.folderName="workbook",this._workBook={sheets:[],xlsxContentTypes:t,xlsxRels:r,_rels:e.createRelation("workbook.xml.rels","workbook/_rels")}};s.prototype=Object.create(o.prototype);var i=function(e){if(e._sharedStrings&&Object.keys(e._sharedStrings).length){var t=new l({rootNode:"sst",nameSpaces:["http://schemas.openxmlformats.org/spreadsheetml/2006/main"]}),r="";for(var n in e._sharedStrings)r+="<si><t>"+n+"</t></si>";return t.format(r)}return""};return s.prototype.generateContent=function(e){var t,r=new l({rootNode:"workbook",nameSpaces:["http://schemas.openxmlformats.org/spreadsheetml/2006/main",{value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",attribute:"r"}]}),o="<sheets>";for(t=0;t<this._workBook.sheets.length;t++){o+=new n('<sheet name="{0}" sheetId="{1}" r:id="{2}"/>').format(this._workBook.sheets[t]._sheet.sheetName,this._workBook.sheets[t]._sheet.sheetId,this._workBook.sheets[t]._sheet.rId),e&&this._workBook.sheets[t].attach(e)}return o+="</sheets>",r.format(o)},s.prototype.getLastSheet=function(){return this._workBook._rels.relations.length?this._workBook._rels.relations[this._workBook._rels.relations.length-1]:{}},s.prototype.addSheet=function(e){var r=this.getLastSheet(),l=parseInt((r.Id||"rId0").replace("rId",""),10)+1;e=e||"sheet"+l,this._workBook._rels.addRelation("rId"+l,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","sheets/sheet"+l+".xml");var n=t.createSheet(e,l,"rId"+l,this,this._workBook.xlsxContentTypes);return this._workBook.sheets.push(n),this._workBook.xlsxContentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",{PartName:"/workbook/sheets/sheet"+l+".xml"}),n},s.prototype.attachChild=function(e){this._workBook._rels.attach(e);var t=i(this._workBook);t&&e.addFile(t,"sharedstrings.xml","workbook"),this._workBook._styles&&this._workBook._styles.attach(e)},s.prototype.createSharedString=function(e){if(e){if(!this._workBook._sharedStrings){this._workBook._sharedStrings={},this._workBook.xlsxContentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",{PartName:"/workbook/sharedstrings.xml"});var t=this.getLastSheet(),r=parseInt((t.Id||"rId0").replace("rId",""),10)+1;this._workBook._rels.addRelation("rId"+r,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings","sharedstrings.xml")}return isNaN(this._workBook._sharedStrings[e])&&(this._workBook._sharedStrings[e]=Object.keys(this._workBook._sharedStrings).length||0),this._workBook._sharedStrings[e]}},s.prototype.getSharedString=function(e){return this._workBook._sharedStrings[e]},s.prototype.createStyles=function(){return this._workBook._styles||(this._workBook._styles=r.createStyle(this,this._workBook._rels,this._workBook.xlsxContentTypes)),this._workBook._styles},{createWorkbook:function(e,t){return new s(e,t)}}}),n("oxml_xlsx",["fileHandler","oxml_content_types","oxml_rels","oxml_workbook"],function(r,l,n,o){"use strict";var s={},i=function(l,n,o){try{var s,i;if("undefined"==typeof window)s=e(),i=t;else if("undefined"==typeof JSZip){if(n)n("Err: JSZip reference not found.");else if("undefined"!=typeof Promise)return new Promise(function(e,t){t("Err: JSZip reference not found.")})}else s=new JSZip;var a=(new r).createFile(s,i);return o.contentTypes.attach(a),o._rels.attach(a),o.workBook.attach(a),a.saveFile(l,n)}catch(e){if(n)n("Err: Not able to create Workbook.");else if("undefined"!=typeof Promise)return new Promise(function(e,t){t("Err: Not able to create Workbook.")})}},a=function(){var e={};e.contentTypes=l.createContentType(),e.contentTypes.addContentType("Default","application/vnd.openxmlformats-package.relationships+xml",{Extension:"rels"}),e.contentTypes.addContentType("Default","application/xml",{Extension:"xml"}),e.contentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",{PartName:"/workbook/workbook.xml"}),e._rels=n.createRelation(".rels","_rels"),e._rels.addRelation("rId1","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","workbook/workbook.xml"),e.workBook=o.createWorkbook(e.contentTypes,e._rels);var t=function(t,r){return i(t,r,e)};return{_xlsx:e,sheet:e.workBook.addSheet.bind(e.workBook),download:t}};return s.xlsx=a,"undefined"==typeof window||window.oxml||(window.oxml=s),s}),l("oxml_xlsx")});