!function(e,t){if("function"==typeof define&&define.amd)define([],t);else if("function"==typeof define)define(t);else if("undefined"!=typeof module&&module.exports){var r=require("jszip"),l=require("fs");module.exports=t(r,l)}else e.oxml=t()}(this,function(e,t){var r,l,n;return function(e){function t(e,t){return b.call(e,t)}function o(e,t){var r,l,n,o,s,a,i,u,f,d,c,m=t&&t.split("/"),v=p.map,y=v&&v["*"]||{};if(e){for(s=(e=e.split("/")).length-1,p.nodeIdCompat&&C.test(e[s])&&(e[s]=e[s].replace(C,"")),"."===e[0].charAt(0)&&m&&(e=m.slice(0,m.length-1).concat(e)),f=0;f<e.length;f++)if("."===(c=e[f]))e.splice(f,1),f-=1;else if(".."===c){if(0===f||1===f&&".."===e[2]||".."===e[f-1])continue;f>0&&(e.splice(f-1,2),f-=2)}e=e.join("/")}if((m||y)&&v){for(f=(r=e.split("/")).length;f>0;f-=1){if(l=r.slice(0,f).join("/"),m)for(d=m.length;d>0;d-=1)if((n=v[m.slice(0,d).join("/")])&&(n=n[l])){o=n,a=f;break}if(o)break;!i&&y&&y[l]&&(i=y[l],u=f)}!o&&i&&(o=i,a=u),o&&(r.splice(0,a,o),e=r.join("/"))}return e}function s(t,r){return function(){var l=x.call(arguments,0);return"string"!=typeof l[0]&&1===l.length&&l.push(null),c.apply(e,l.concat([t,r]))}}function a(e){return function(t){y[e]=t}}function i(r){if(t(h,r)){var l=h[r];delete h[r],g[r]=!0,d.apply(e,l)}if(!t(y,r)&&!t(g,r))throw new Error("No "+r);return y[r]}function u(e){var t,r=e?e.indexOf("!"):-1;return r>-1&&(t=e.substring(0,r),e=e.substring(r+1,e.length)),[t,e]}function f(e){return e?u(e):[]}var d,c,m,v,y={},h={},p={},g={},b=Object.prototype.hasOwnProperty,x=[].slice,C=/\.js$/;m=function(e,t){var r,l=u(e),n=l[0],s=t[1];return e=l[1],n&&(r=i(n=o(n,s))),n?e=r&&r.normalize?r.normalize(e,function(e){return function(t){return o(t,e)}}(s)):o(e,s):(n=(l=u(e=o(e,s)))[0],e=l[1],n&&(r=i(n))),{f:n?n+"!"+e:e,n:e,pr:n,p:r}},v={require:function(e){return s(e)},exports:function(e){var t=y[e];return void 0!==t?t:y[e]={}},module:function(e){return{id:e,uri:"",exports:y[e],config:function(e){return function(){return p&&p.config&&p.config[e]||{}}}(e)}}},d=function(r,l,n,o){var u,d,c,p,b,x,C,_=[],S=typeof n;if(o=o||r,x=f(o),"undefined"===S||"function"===S){for(l=!l.length&&n.length?["require","exports","module"]:l,b=0;b<l.length;b+=1)if(p=m(l[b],x),"require"===(d=p.f))_[b]=v.require(r);else if("exports"===d)_[b]=v.exports(r),C=!0;else if("module"===d)u=_[b]=v.module(r);else if(t(y,d)||t(h,d)||t(g,d))_[b]=i(d);else{if(!p.p)throw new Error(r+" missing "+d);p.p.load(p.n,s(o,!0),a(d),{}),_[b]=y[d]}c=n?n.apply(y[r],_):void 0,r&&(u&&u.exports!==e&&u.exports!==y[r]?y[r]=u.exports:c===e&&C||(y[r]=c))}else r&&(y[r]=n)},r=l=c=function(t,r,l,n,o){if("string"==typeof t)return v[t]?v[t](r):i(m(t,f(r)).f);if(!t.splice){if((p=t).deps&&c(p.deps,p.callback),!r)return;r.splice?(t=r,r=l,l=null):t=e}return r=r||function(){},"function"==typeof l&&(l=n,n=o),n?d(e,t,r,l):setTimeout(function(){d(e,t,r,l)},4),c},c.config=function(e){return c(e)},r._defined=y,(n=function(e,r,l){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");r.splice||(l=r,r=[]),t(y,e)||t(h,e)||(h[e]=[e,r,l])}).amd={jQuery:!0}}(),n("build/almond",function(){}),n("fileHandler",[],function(){"use strict";return{createFile:function(e,t){var r=e,l={_zip:r};return l.addFile=function(e,t,l){var n;l&&(n=r.folder(l)),(n||r).file(t,e)},l.saveFile=function(e,l){return"undefined"!=typeof window?r.generateAsync({type:"blob"}).then(function(t){try{if(window.saveAs)return saveAs(t,e);var n=window.URL.createObjectURL(t),o=document.createElement("a");if(o.setAttribute("href",n),o.setAttribute("download",e),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),l)l(r);else if("undefined"!=typeof Promise)return new Promise(function(e,t){e(r)})}catch(e){if(l)l(null,"Err: Not able to create file object.");else if("undefined"!=typeof Promise)return new Promise(function(e,t){t("Err: Not able to create file object.")})}}):l?(r.generateNodeStream({type:"nodebuffer",streamFiles:!0}).pipe(t.createWriteStream(e)),void l(r)):new Promise(function(l,n){r.generateNodeStream({type:"nodebuffer",streamFiles:!0}).pipe(t.createWriteStream(e)),l(r)})},l}}}),n("oxml_rels",[],function(){"use strict";var e=function(e,t,r,l){l.relations.push({Id:e,Type:t,Target:r})},t=function(e){var t,r='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">';for(t=0;t<e.relations.length;t++){var l=e.relations[t];r+='<Relationship Id="'+l.Id+'" Type="'+l.Type+'" Target="'+l.Target+'"/>'}return r+="</Relationships>"},r=function(e,r){var l=t(r);e.addFile(l,r.fileName,r.folderName)};return{createRelation:function(t,l){var n={relations:[],fileName:t,folderName:l};return n.addRelation=function(t,r,l){e(t,r,l,n)},n.attach=function(e){return r(e,n)},n}}}),n("oxml_content_types",[],function(){"use strict";var e=function(e){var t,r='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">';for(t=0;t<e.contentTypes.length;t++){var l=e.contentTypes[t];r+="<"+l.name+' ContentType="'+l.contentType+'" ',l.Extension&&(r+='Extension="'+l.Extension+'" '),l.PartName&&(r+='PartName="'+l.PartName+'" '),r+="/>\n"}return r+="</Types>"},t=function(t,r){var l=e(r);t.addFile(l,"[Content_Types].xml")},r=function(e,t,r,l){var n={name:e,contentType:t};for(var o in r)n[o]=r[o];l.contentTypes.push(n)};return{createContentType:function(){var e={contentTypes:[]};return e.addContentType=function(t,l,n){r(t,l,n,e)},e.attach=function(r){return t(r,e)},e}}}),n("oxml_table",[],function(){var e=function(e){var t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><table totalsRowShown="0" ref="'+e.fromCell+":"+e.toCell+'" displayName="'+e.displayName+'" name="'+e.displayName+'" id="'+e.rid+'" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';if(e.filters){t+='<autoFilter ref="'+e.fromCell+":"+e.toCell+'">';for(var r=0;r<e.filters.length;r++){if(t+='<filterColumn colId="'+e.filters[r].column+'">',"default"===e.filters[r].values[0].type){t+="<filters>";for(var l=0;l<e.filters[r].values.length;l++)t+='<filter val="'+e.filters[r].values[l].value+'"/>';t+="</filters>"}else if("custom"===e.filters[r].values[0].type){t+='<customFilters and="'+(e.filters[r].values[0].and?"1":"0")+'">';for(var l=0;l<e.filters[r].values.length;l++)t+='<customFilter operator="'+e.filters[r].values[l].operator+'" val="'+e.filters[r].values[l].value+'"/>';t+="</customFilters>"}t+="</filterColumn>"}t+="</autoFilter>"}e.sort&&(t+='<sortState caseSensitive="'+(e.sort.caseSensitive?"1":"0")+'" ref="'+e.sort.dataRange+'">',t+="<sortCondition"+("ascending"===e.sort.direction?"":' descending="1"')+' ref="'+e.sort.range+'"/>',t+="</sortState>"),t+='<tableColumns count="'+e.columns.length+'">';for(var r=0;r<e.columns.length;r++)t+='<tableColumn name="'+e.columns[r]+'" id="'+(r+1)+'"/>';var n="";return e.tableStyle&&(n='<tableStyleInfo name="'+e.tableStyle.name+'" showColumnStripes="'+(e.tableStyle.showColumnStripes?"1":"0")+'" showRowStripes="'+(e.tableStyle.showRowStripes?"1":"0")+'" showLastColumn="'+(e.tableStyle.showLastColumn?"1":"0")+'" showFirstColumn="'+(e.tableStyle.showFirstColumn?"1":"0")+'"/>'),t+="</tableColumns>"+n+"</table>"},t=function(t,r){var l=e(t);r.addFile(l,"table"+t.rid+".xml","workbook/tables")},r=function(e,t,r){if(t.filters||(t.filters=[]),"object"==typeof e.filters&&e.filters.length)for(var l=0;l<e.filters.length;l++)if(e.filters[l].column){var n;if(e.filters[l].value)n=[],n.push({value:e.filters[l].value,type:e.filters[l].type||"default",operator:e.filters[l].operator||null,and:!1!==e.filters[l].and}),o(r,e.filters[l].column-1,[e.filters[l].value],t.fromCell,t.toCell,e.filters[l].operator);else if(e.filters[l].values&&"object"==typeof e.filters[l].values&&e.filters[l].values.length){n=[];for(var s=0;s<e.filters[l].values.length;s++)n.push({value:e.filters[l].values[s],type:e.filters[l].type||"default",operator:e.filters[l].operator||null,and:!1!==e.filters[l].and});o(r,e.filters[l].column-1,e.filters[l].values,t.fromCell,t.toCell,e.filters[l].operator)}t.filters.push({column:e.filters[l].column-1,values:n})}},l=function(e,t){var r={},l=t.fromColumn-1,n=t.toColumn-1,o=t.fromRow,s=t.toRow;"number"==typeof e.sort?(l=String.fromCharCode(e.sort+l+64),r.direction="ascending",r.caseSensitive=!0):"object"==typeof e.sort&&!e.sort.length&&e.sort.column&&(l=String.fromCharCode(e.sort.column+l+64),r.direction=e.sort.direction||"ascending",r.caseSensitive=void 0===e.sort.caseSensitive||e.sort.caseSensitive),r.range=l+(o+1)+":"+l+s,r.dataRange=String.fromCharCode(t.fromColumn+64)+(o+1)+":"+String.fromCharCode(n+65)+s,t.sort=r},n=function(e,t,n){e&&(e.filters&&r(e,t,n),e.sort&&l(e,t))},o=function(e,t,r,l,n,o){var s=parseInt(l.match(/\d+/)[0],10),a=parseInt(n.match(/\d+/)[0],10);t+=l.match(/\D+/)[0].toUpperCase().charCodeAt()-65;for(var i=s;i<a;i++){var u=!1;if(e.values[i])if(!o||"greaterThan"!==o&&"greaterThanOrEqual"!==o&&"lessThan"!==o&&"lessThanOrEqual"!==o)u="notEqual"===o?r.indexOf(e.values[i][t].value)>-1:!(r.indexOf(e.values[i][t].value)>-1);else{u=!0;for(var f=0;f<r.length;f++){switch(o){case"greaterThan":e.values[i][t].value>r[f]&&(u=!1);break;case"greaterThanOrEqual":case"lessThan":case"lessThanOrEqual":e.values[i][t].value>=r[f]&&(u=!1)}if(!u)break}}u&&(e.values[i].hidden=!0)}},s=function(e,t,r,l){r._workBook.createStyles().addTableStyle(e,t,l),l.tableStyle={name:t,showColumnStripes:!(!e.evenColumn&&!e.oddColumn),showRowStripes:!(!e.evenRow&&!e.oddRow),showLastColumn:!!e.lastColumn,showFirstColumn:!!e.firstColumn}},a=function(e,t,r){return{name:e.displayName,columns:e.columns,fromCell:e.fromCell,toCell:e.toCell,sort:e.sort,filters:e.filters,set:function(l){return n(l,e,t),a(e,t,r)},style:function(l,n){return n||(n="customTableStyle"+r),s(l,n,t,e),a(e,t,r)}}};return{addTable:function(e,r,l,o,s,i,u){var f=parseInt(r.match(/\d+/)[0],10),d=parseInt(l.match(/\d+/)[0],10),c=r.match(/\D+/)[0].toUpperCase().charCodeAt()-64,m=l.match(/\D+/)[0].toUpperCase().charCodeAt()-64,v={rid:s,displayName:e,columns:o,fromCell:r,toCell:l,fromRow:f,toRow:d,fromColumn:c,toColumn:m};return n(i,v,u),{_table:v,rid:s,attach:function(e){t(v,e)},tableOptions:function(){return a(v,u,s)}}}}}),n("oxml_sheet",["oxml_table","oxml_rels"],function(e,t){"use strict";var r=function(e,t,r,l){if(!e)return"";var n=e.styleIndex?'s="'+e.styleIndex+'"':"";if("numeric"===e.type)return'<c r="'+t+'" '+n+"><v>"+e.value+"</v></c>";if("sharedString"===e.type)return'<c r="'+t+'" t="s" '+n+"><v>"+e.value+"</v></c>";if("sharedFormula"===e.type){var o="";return e.value&&"function"==typeof e.value?o="<v>"+e.value(r+1,l+1)+"</v>":void 0!==e.value&&null!==e.value&&(o="<v>"+e.value+"</v>"),e.formula?'<c  r="'+t+'" '+n+'><f t="shared" ref="'+e.range+'" si="'+e.si+'">'+e.formula+"</f>"+o+"</c>":'<c  r="'+t+'" '+n+'><f t="shared" si="'+e.si+'"></f>'+o+"</c>"}if("string"===e.type)return'<c r="'+t+'" t="inlineStr" '+n+"><is><t>"+e.value+"</t></is></c>";if("formula"===e.type){var o="";return e.value&&"function"==typeof e.value?o="<v>"+e.value(r+1,l+1)+"</v>":void 0!==e.value&&null!==e.value&&(o="<v>"+e.value+"</v>"),'<c r="'+t+'" '+n+"><f>"+e.formula+"</f>"+o+"</c>"}},l=function(e,t){var l=0,n="";if(e.values&&e.values.length)for(l=0;l<e.values.length;l++)if(e.values[l]&&e.values[l].length>0){var o=e.values[l].hidden?' hidden="1" ':"";n+='<row r="'+(l+1)+'"'+o+">";var s=0;for(s=0;s<e.values[l].length;s++){var a=String.fromCharCode(65+s),i=e.values[l][s],u=a+(l+1),f=r(i,u,l,s);n+=f}n+="</row>"}var d="";if(e.tables&&e.tables.length){d+='<tableParts count="'+e.tables.length+'">';for(var c=0;c<e.tables.length;c++)d+='<tablePart r:id="rId'+e.tables[c].rid+'"/>',t&&e.tables[c].attach(t);d+="</tableParts>"}return'<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><sheetData>'+n+"</sheetData>"+d+"</worksheet>"},n=function(e,t){var r=l(e,t);t.addFile(r,"sheet"+e.sheetId+".xml","workbook/sheets"),e._rels&&e._rels.attach(t)},o=function(e,t){if(void 0===e||null===e)return null;if("object"==typeof e){if(!(void 0!==e.value&&null!==e.value||e.formula&&"formula"===e.type))return null;if(e.type)return"sharedString"===e.type?"number"==typeof e.value?{type:e.type,value:e.value}:(e.value=t._workBook.createSharedString(e.value,t._workBook),{type:e.type,value:e.value}):"formula"===e.type?{type:e.type,formula:e.formula,value:e.value}:"numeric"===e.type||"string"===e.type?{type:e.type,value:e.value}:null;e=e.value}return"number"==typeof e?{type:"numeric",value:e}:"string"==typeof e?{type:"string",value:e}:null},s=function(e,t,r,l,n,s){var a,i;if(n){n.cellIndices=s;i=t._workBook.createStyles().addStyles(n)}for(a=0;a<e.length;a++)if(void 0!==e[a]||null!==e[a]){var u=a+r-1;if(t.values[u]||(t.values[u]=[]),"object"==typeof e[a]&&e[a].length>=0){var f;for(f=0;f<e[a].length;f++){var d=o(e[a][f],t);d&&(i&&(d.styleIndex=i.index),i||!t.values[u][f+l-1]?t.values[u][f+l-1]=d:(t.values[u][f+l-1].value=d.value,t.values[u][f+l-1].type=d.type))}}else{var d=o(e[a],t);d&&(i&&(d.styleIndex=i.index),i||!t.values[u][l-1]?t.values[u][l-1]=d:(t.values[u][l-1].value=d.value,t.values[u][l-1].type=d.type))}}},a=function(e,t,r,l,n){var s=String.fromCharCode(65+l-1)+r,a=r-1;if(void 0!==e&&null!==e){if(t.values[a]||(t.values[a]=[]),e=o(e,t),n){n.cellIndex=s;var u=t._workBook.createStyles();e.styleIndex=u.addStyles(n).index}e&&!e.styleIndex&&t.values[a][l-1]&&(e.styleIndex=t.values[a][l-1].styleIndex),t.values[a][l-1]=e}return i(t,s,a,l-1)},i=function(e,t,r,l){return{style:function(n){return n.cellIndex=t,f(e,n,r,l),i(e,t,r,l)},value:e.values[r]&&e.values[r][l]?e.values[r][l].value:null,type:e.values[r]&&e.values[r][l]?e.values[r][l].type:null,cellIndex:t,rowIndex:r+1,columnIndex:String.fromCharCode(65+l),formula:e.values[r]&&e.values[r][l]?e.values[r][l].formula:void 0,set:function(n,o){return m(e,r+1,l+1,n,o),this.value=e.values[r]&&e.values[r][l]?e.values[r][l].value:null,this.formula=e.values[r]&&e.values[r][l]?e.values[r][l].formula:void 0,this.type=e.values[r]&&e.values[r][l]?e.values[r][l].type:null,i(e,t,r,l)}}},u=function(e,t,r,l,n,o,s,a,c){var y,h=[];for(y=0;y<r.length;y++){var p=r[y].rowIndex,g=r[y].columnIndex,b=e.values[p]&&e.values[p][g]?e.values[p][g].value:null,x=e.values[p]&&e.values[p][g]?e.values[p][g].formula:void 0,C=e.values[p]&&e.values[p][g]?e.values[p][g].type:null,_=String.fromCharCode(65+g)+(p+1),S="sharedFormula"===C?e.values[p][g].si:void 0;h.push({style:function(t){return t.cellIndex=_,f(e,t,p,g),i(e,_,p,g)},rowIndex:p+1,columnIndex:String.fromCharCode(65+g),value:b,formula:x,cellIndex:_,sharedFormulaIndex:S,type:C,set:function(t,r){return m(e,p+1,g+1,t,r),this.value=e.values[p]&&e.values[p][g]?e.values[p][g].value:null,this.formula=e.values[p]&&e.values[p][g]?e.values[p][g].formula:void 0,this.type=e.values[p]&&e.values[p][g]?e.values[p][g].type:null,i(e,_,p,g)}})}return{style:function(a){return a.cellIndices=t,d(e,a,r),u(e,t,r,l,n,o,s)},cellIndices:t,cells:h,set:function(i,f){var d=[];if(!(i&&i.length&&s&&o))return u(e,t,r,l,n,o,s);if(a||c)for(var m=0;m<this.cells.length&&m<i.length;m++)d.push(i[m]);if(a)i=[d];else if(c)i=d;else{for(var d=[],m=0;m<i.length&&m<o;m++)if(i[m]){var y=[];if(i[m].length>s){for(var h=0;h<i[m].length&&h<s;h++)y.push(i[m][h]);i[m]=y}d.push(i[m])}else d.push([]);i=d}v(e,l,n,o,s,i,f,!1,a,c);var p=u(e,t,r,l,n,o,s);return this.cells=p.cells,p}}},f=function(e,t,r,l){var n=e._workBook.createStyles(),o=n.addStyles(t).index;e.values[r]||(e.values[r]=[]),e.values[r][l]||(e.values[r][l]={value:"",type:"string"}),e.values[r][l].styleIndex=o},d=function(e,t,r){for(var l=e._workBook.createStyles(),n=l.addStyles(t).index,o=0;o<r.length;o++)e.values[r[o].rowIndex]||(e.values[r[o].rowIndex]=[]),e.values[r[o].rowIndex][r[o].columnIndex]||(e.values[r[o].rowIndex][r[o].columnIndex]={type:"string",value:""}),e.values[r[o].rowIndex][r[o].columnIndex].styleIndex=n},c=function(e,t,r,l,n){var o,s=[],a=[];if(r&&t&&l){var i;if("object"==typeof t&&!t.length){if(!t.formula)return;i=t.value,t=t.formula}var f=r.match(/\D+/)[0],d=r.match(/\d+/)[0];if(e._sharedFormula){o=e._sharedFormula[e._sharedFormula.length-1].si+1}else e._sharedFormula=[],o=0;e._sharedFormula.push({si:o,fromCell:r,toCell:l,formula:t});var c=f.toUpperCase().charCodeAt()-65,m=parseInt(d,10);e.values[m-1]||(e.values[m-1]=[]),e.values[m-1][c]={type:"sharedFormula",si:o,formula:t,range:r+":"+l,value:i},s.push(String.fromCharCode(65+c)+m),a.push({rowIndex:m-1,columnIndex:c});var v,y;if(l&&(v=l.match(/\D+/)[0],y=l.match(/\d+/)[0]),y===d){var h=v.toUpperCase().charCodeAt()-65;for(c++;c<=h;c++)e.values[m-1][c]={type:"sharedFormula",si:o,value:i},s.push(String.fromCharCode(65+c)+m),a.push({rowIndex:m-1,columnIndex:c})}else if(v===f){var p=parseInt(y,10);for(m++;m<=p;m++)e.values[m-1]||(e.values[m-1]=[]),s.push(String.fromCharCode(65+c)+m),a.push({rowIndex:m-1,columnIndex:c}),e.values[m-1][c]={type:"sharedFormula",si:o,value:i}}if(n){n.cellIndices=s;var g;g=e._workBook.createStyles().addStyles(n);for(var b=0;b<a.length;b++)e.values[a[b].rowIndex][a[b].columnIndex].styleIndex=g.index}return u(e,s,a)}},m=function(e,t,r,l,n){if(t&&r&&"number"==typeof t&&"number"==typeof r){if(n||void 0!==l&&null!==l)return n||"object"!=typeof l||l.type||void 0!==l.value&&null!==l.value?void 0===l||null===l?y(e,t,r,n):a(l,e,t,r,n):y(e,t,r,l);var o=String.fromCharCode(65+r-1)+t;return i(e,o,t-1,r-1)}},v=function(e,t,r,l,n,o,a,i,f,c){if(t&&r&&"number"==typeof t&&"number"==typeof r&&"number"==typeof l&&"number"==typeof n){for(var m=[],v=[],y=l,h=t-1;y>0;h++,y--){var p=n;e.values[h]||(e.values[h]=[]);for(var g=r-1;p>0;g++,p--)v.push(String.fromCharCode(65+g)+(h+1)),m.push({rowIndex:h,columnIndex:g})}if(a||o){if(a||!o||o.length){if(void 0===o||null===o){if(a.cellIndices=v,d(e,a,m),!i)return;return u(e,v,m,t,r,l,n,f,c)}if(s(o,e,t,r,a,v),!i)return;return u(e,v,m,t,r,l,n,f,c)}if(o.cellIndices=v,d(e,o,m),!i)return;return u(e,v,m,t,r,l,n,f,c)}return u(e,v,m,t,r,l,n,f,c)}},y=function(e,t,r,l){var n=String.fromCharCode(65+r-1)+t;return l.cellIndex=n,f(e,l,t-1,r-1),i(e,n,t-1,r-1)},h=function(r,l,n,o,s,a){var i=[],u=o.match(/\D+/)[0].toUpperCase().charCodeAt()-65,f=parseInt(o.match(/\d+/)[0],10),d=s.match(/\D+/)[0].toUpperCase().charCodeAt()-65,c=r.values[f-1];if(c){for(var m=u;m<=d;m++)i.push(c[m]&&c[m].value?c[m].value:"");r._rels||(r._rels=t.createRelation("sheet"+r.sheetId+".xml.rels","workbook/sheets/_rels"));var v=p(r);r._rels.addRelation("rId"+v,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table","../tables/table"+v+".xml"),l.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml",{PartName:"/workbook/tables/table"+v+".xml"}),r.tables||(r.tables=[]);var y=e.addTable(n,o,s,i,v,a,r);return r.tables.push(y),y}},p=function(e){var t={};return e._rels.relations.length&&(t=e._rels.relations[e._rels.relations.length-1]),parseInt((t.Id||"rId0").replace("rId",""),10)+1};return{createSheet:function(e,t,r,l,o){var s={sheetName:e,sheetId:t,rId:r,values:[],_workBook:l};return{_sheet:s,attach:function(e){n(s,e)},sharedFormula:function(e,t,r,l){return c(s,r,e,t,l)},cell:function(e,t,r,l){return m(s,e,t,r,l)},row:function(e,t,r,l){var n=s.values[e-1]?s.values[e-1].length-t+1:0;return v(s,e,t,1,r?r.length:n,r?[r]:null,l,!0,!0,!1)},column:function(e,t,r,l){var n=0;return r&&r.length||(n=s.values&&s.values.length&&s.values.length>e?s.values.length-e+1:0),v(s,e,t,r?r.length:n,1,r,l,!0,!1,!0)},grid:function(e,t,r,l){var n,o=0,a=0;if(r&&r.length)for(o=r.length,n=0;n<r.length;n++)r[n]&&r[n].length&&(a=a<r[n].length?r[n].length:a);else if(s.values&&s.values.length){o=s.values.length-e+1;for(var n=0;n<s.values.length;n++)s.values[n]&&s.values[n].length&&(a=a<s.values[n].length-t+1?s.values[n].length-t+1:a)}return v(s,e,t,o,a,r,l,!0,!1)},table:function(e,t,r,l){var n=h(s,o,e,t,r,l);return n?n.tableOptions():void 0}}}}}),n("utils",[],function(){return sortObject=function(e){if("object"!=typeof e||e.length)return e;var t={},r=[];for(var l in e)r.push(l);r.sort();for(var n in r)t[r[n]]=sortObject(e[r[n]]);return t},{stringify:function(e){return JSON.stringify(sortObject(e))}}}),n("oxml_xlsx_font",["utils"],function(e){var t=function(e){var t,l="";l+='<fonts count="'+e._fontsCount+'">';for(t in e._fonts){var n=JSON.parse(t);l+=r(n)}return l+="</fonts>"},r=function(e){var t="<font>";return t+=e.strike?"<strike/>":"",t+=e.italic?"<i/>":"",t+=e.bold?"<b/>":"",t+=e.underline?"<u/>":"",t+=e.size?'<sz val="'+e.size+'"/>':"",t+=e.color?'<color rgb="'+e.color+'"/>':"",t+=e.name?'<name val="'+e.name+'"/>':"",t+=e.family?'<family val="'+e.family+'"/>':"",t+=e.scheme?'<scheme val="'+e.scheme+'"/>':"",t+="</font>"},l=function(e){var t={};return t.bold=!!e.bold,t.italic=!!e.italic,t.underline=!!e.underline,t.size=e.fontSize||!1,t.color=e.fontColor||!1,t.name=e.fontName||!1,t.family=e.fontFamily||!1,t.scheme=e.scheme||!1,t.strike=!!e.strike,t},n=function(t,r){return r._fonts[e.stringify(t)]},o=function(e,t){for(var r,l=0,n=0,o=0;o<t.length;o++)for(var s=t[0];l<e.styles.length;l++)if((void 0!==e.styles[l].cellIndices[s]||null!==e.styles[l].cellIndices[s])&&(r=e.styles[l],n++,Object.keys(r.cellIndices).length!==t.length||n>1||0===r._font))return!1;return!!r&&r._font},s=function(t,r){var l=r._fontsCount++;return r._fonts[e.stringify(t)]=""+l,r._fonts[e.stringify(t)]},a=function(t,r,l){return u(t,r,l,!0),l._fonts[e.stringify(t)]=r,r},i=function(e,t){var r=l(e);if(t){for(var n in r)r[n]&&(t[n]=r[n]);return t}return r},u=function(t,r,l,n){var o;for(var s in l._fonts)if(l._fonts[s]===r){o=JSON.parse(s);break}n&&delete l._fonts[e.stringify(o)];for(var s in t)t[s]&&(o[s]=t[s]),t[s]=o[s];return t},f=function(e,t){var r,l=0;for(r=0;r<t.styles.length;r++)if(t.styles[r]._font===e&&(l+=Object.keys(t.styles[r].cellIndices).length)>1)return l;return l},d=function(e,t){var r,i=!1,u=l(t),f=e._fonts?n(u,e):null;return void 0!==f&&null!==f?r=f:i=!0,r||!1!==(f=o(e,t.cellIndices))&&(r=a(u,f,e)),void 0!==r&&null!==r||(r=s(u,e)),{font:u,fontIndex:r,newStyleCreated:i}};return{createTableFont:i,getFontForCell:function(e,t,r){var o,i=!1,d=l(t),c=e._fonts?n(d,e):null;if(void 0!==c&&null!==c?o=c:i=!0,r&&r._font){f(r._font,e)<=1?o=a(d,r._font,e):(d=u(d,r._font,e),c=n(d,e),void 0!==c&&null!==c?o=c:(o=null,i=!0))}return void 0!==o&&null!==o||(o=s(d,e)),{font:d,fontIndex:o,newStyleCreated:i}},getFontForCells:d,generateContent:t,generateSingleContent:r}}),n("oxml_xlsx_num_format",["utils"],function(e){var t=function(e){var t="";if(e._numFormats){t+='<numFmts count="'+Object.keys(e._numFormats).length+'">';var r;for(r in e._numFormats){var l=JSON.parse(r);t+='<numFmt numFmtId="'+e._numFormats[r]+'" formatCode="'+l.formatString+'"/>'}t+="</numFmts>"}return t},r=function(e){var t={};return t.formatString=e.numberFormat,t},l=function(t,r){return r._numFormats[e.stringify(t)]},n=function(t,r){r._numFormats||(r._numFormats={},r._numFormatsCount=200);var l=r._numFormatsCount++;return r._numFormats[e.stringify(t)]=""+l,r._numFormats[e.stringify(t)]},o=function(t,r,l){var n;for(var o in l._numFormats)if(l._numFormats[o]===r){n=JSON.parse(o);break}return t.formatString?(delete l._numFormats[e.stringify(n)],l._numFormats[e.stringify(t)]=r):t.formatString=n.formatString,r},s=function(e,t){var r,l=0;for(r=0;r<t.styles.length;r++)if(t.styles[r]._numFormat===e&&(l+=Object.keys(t.styles[r].cellIndices).length)>1)return l;return l},a=function(e,t){for(var r,l=0,n=0,o=0;o<t.length;o++)for(var s=t[0];l<e.styles.length;l++)if((void 0!==e.styles[l].cellIndices[s]||null!==e.styles[l].cellIndices[s])&&(r=e.styles[l],n++,Object.keys(r.cellIndices).length!==t.length||n>1))return!1;return!!r&&r._numFormat},i=function(e,t){var s,i=!1,u=r(t),f=e._numFormats?l(u,e):null;return void 0!==f&&null!==f?s=f:u.formatString&&(i=!0),s||!1!==(f=a(e,t.cellIndices))&&(s=o(u,f,e)),void 0!==s&&null!==s||!u.formatString||(s=n(u,e)),{numFormat:u,numFormatIndex:s||!1,newStyleCreated:i}};return{generateContent:t,getNumFormatForCell:function(e,t,a){var i,u=!1,f=r(t),d=e._numFormats?l(f,e):null;if(void 0!==d&&null!==d?i=d:f.formatString&&(u=!0),a&&a._numFormat){s(a._numFormat,e)<=1&&e._numFormats&&(i=o(f,a._numFormat,e))}return void 0!==i&&null!==i||!f.formatString||(i=n(f,e)),{numFormat:f,numFormatIndex:i||!1,newStyleCreated:u}},getNumFormatForCells:i}}),n("oxml_xlsx_border",["utils"],function(e){var t=function(e,t){if(e.style||e.color){return"<"+t+(e.style?' style="'+e.style+'"':"")+">"+(e.color?'<color rgb="'+e.color+'"/>':"")+"</"+t+">"}return"<"+t+"/>"},r=function(e){var t,r="";r+='<borders count="'+e._bordersCount+'">';for(t in e._borders){var n=JSON.parse(t);r+=n?l(n):"<border />"}return r+="</borders>"},l=function(e){var r="<border>";return r+=t(e.left,"left"),r+=t(e.right,"right"),r+=t(e.top,"top"),r+=t(e.bottom,"bottom"),r+=t(e.diagonal,"diagonal"),r+="</border>"},n=function(e){var t={};return!!e.border&&(t.left={color:!!e.border.left&&e.border.left.color||e.border.color||!1,style:!!e.border.left&&e.border.left.style||e.border.style||!1},t.top={color:!!e.border.top&&e.border.top.color||e.border.color||!1,style:!!e.border.top&&e.border.top.style||e.border.style||!1},t.bottom={color:!!e.border.bottom&&e.border.bottom.color||e.border.color||!1,style:!!e.border.bottom&&e.border.bottom.style||e.border.style||!1},t.right={color:!!e.border.right&&e.border.right.color||e.border.color||!1,style:!!e.border.right&&e.border.right.style||e.border.style||!1},t.diagonal={color:!!e.border.diagonal&&e.border.diagonal.color||e.border.color||!1,style:!!e.border.diagonal&&e.border.diagonal.style||e.border.style||!1},t.isValid=t.left.style||t.top.style||t.bottom.style||t.right.style||t.diagonal.style||t.left.color||t.top.color||t.bottom.color||t.right.color||t.diagonal.color,!!t.isValid&&t)},o=function(t,r){return r._borders[e.stringify(t)]},s=function(t,r){var l=r._bordersCount++;return r._borders[e.stringify(t)]=""+l,r._borders[e.stringify(t)]},a=function(e,t){for(var r,l=0,n=0,o=0;o<t.length;o++)for(var s=t[0];l<e.styles.length;l++)if((void 0!==e.styles[l].cellIndices[s]||null!==e.styles[l].cellIndices[s])&&(r=e.styles[l],n++,Object.keys(r.cellIndices).length!==t.length||n>1||0===r._border))return!1;return!!r&&r._border},i=function(t,r,l){return f(t,r,l,!0),l._borders[e.stringify(t)]=r,r},u=function(e,t){var r=n(e);if(t){for(var l in r)r[l]&&(r[l].color||r[l].style)&&(t[l]=r[l]);return t}return r},f=function(t,r,l,n){var o;for(var s in l._borders)if(l._borders[s]===r){o=JSON.parse(s);break}if(n&&delete l._borders[e.stringify(o)],t)for(var s in t)(t[s].color||t[s].style)&&(o[s]=t[s]),t[s]=o[s];else t=o;return t},d=function(e,t){var r,l=0;for(r=0;r<t.styles.length;r++)if(t.styles[r]._border===e&&(l+=Object.keys(t.styles[r].cellIndices).length)>1)return l;return l};return{createTableBorder:u,getBorderForCell:function(e,t,r){var l,a=!1,u=n(t),c=e._borders?o(u,e):null;if(void 0!==c&&null!==c?l=c:a=!0,r&&r._border&&r._border!==c){d(r._border,e)<=1&&(l=i(u,r._border,e))}return void 0!==l&&null!==l||(r&&r._border&&(u=f(u,r._border,e,!1)),l=s(u,e)),{border:u,borderIndex:l,newStyleCreated:a}},getBorderForCells:function(e,t){var r,l=!1,u=n(t),f=e._borders?o(u,e):null;return void 0!==f&&null!==f?r=f:l=!0,f=a(e,t.cellIndices),!1!==f&&(r=i(u,f,e)),void 0!==r&&null!==r||(r=s(u,e)),{border:u,borderIndex:r,newStyleCreated:l}},generateContent:r,generateSingleContent:l}}),n("oxml_xlsx_fill",["utils"],function(e){var t=function(e){var t,l="";l+='<fills count="'+e._fillsCount+'">';for(t in e._fills){var n=JSON.parse(t);l+=n?r(n):"<fill/>"}return l+="</fills>"},r=function(e){var t="<fill>";if(e.pattern){var r=e.pattern||"none",l=e.fgColor?'<fgColor rgb="'+e.fgColor+'"/>':"";l+=e.bgColor?'<bgColor rgb="'+e.bgColor+'"/>':"",t+='<patternFill patternType="'+r+'">'+l+"</patternFill>"}else{if(!e.gradient)return"<fill/>";t+="<gradientFill"+(e.gradient.type?' type="'+e.gradient.type+'"':"")+(e.gradient.left?' left="'+e.gradient.left+'"':"")+(e.gradient.right?' right="'+e.gradient.right+'"':"")+(e.gradient.top?' top="'+e.gradient.top+'"':"")+(e.gradient.bottom?' bottom="'+e.gradient.bottom+'"':"")+(e.gradient.degree?' degree="'+e.gradient.degree+'"':"")+">";for(var n=0;n<e.gradient.stops.length;n++)t+='<stop position="'+e.gradient.stops[n].position+'">',t+='<color rgb="'+e.gradient.stops[n].color+'"/></stop>';t+="</gradientFill>"}return t+"</fill>"},l=function(e){if(e.fill&&e.fill.pattern){var t={};return t.pattern=e.fill.pattern,t.fgColor=e.fill.foreColor||!1,t.bgColor=e.fill.backColor||e.fill.color||!1,t}if(e.fill&&e.fill.gradient&&e.fill.gradient.stops){var t={};t.gradient={},t.gradient.degree=e.fill.gradient.degree||!1,t.gradient.bottom=e.fill.gradient.bottom||!1,t.gradient.left=e.fill.gradient.left||!1,t.gradient.right=e.fill.gradient.right||!1,t.gradient.top=e.fill.gradient.top||!1,t.gradient.type=e.fill.gradient.type||!1,t.gradient.stops=[];for(var r=0;r<e.fill.gradient.stops.length;r++){var l={};l.position=e.fill.gradient.stops[r].position||0,l.color=e.fill.gradient.stops[r].color||!1,t.gradient.stops.push(l)}return t}return!1},n=function(t,r){return r._fills[e.stringify(t)]},o=function(t,r){var l=r._fillsCount++;return r._fills[e.stringify(t)]=""+l,r._fills[e.stringify(t)]},s=function(e,t){for(var r,l=0,n=0,o=0;o<t.length;o++)for(var s=t[0];l<e.styles.length;l++)if((void 0!==e.styles[l].cellIndices[s]||null!==e.styles[l].cellIndices[s])&&(r=e.styles[l],n++,Object.keys(r.cellIndices).length!==t.length||n>1||0===r._fill))return!1;return!!r&&r._fill},a=function(t,r,l){return u(t,r,l,!0),l._fills[e.stringify(t)]=r,r},i=function(e,t){return l(e)||t||!1},u=function(t,r,l,n){var o;for(var s in l._fills)if(l._fills[s]===r){o=JSON.parse(s);break}n&&delete l._fills[e.stringify(o)];for(var s in t)t[s]&&(o[s]=t[s]),t[s]=o[s];return t},f=function(e,t){var r,i=!1,u=l(t),f=e._fills?n(u,e):null;return void 0!==f&&null!==f?r=f:i=!0,r||!1!==(f=s(e,t.cellIndices))&&(r=a(u,f,e)),void 0!==r&&null!==r||(r=o(u,e)),{fill:u,fillIndex:r,newStyleCreated:i}},d=function(e,t){var r,l=0;for(r=0;r<t.styles.length;r++)if(t.styles[r]._fill===e&&(l+=Object.keys(t.styles[r].cellIndices).length)>1)return l;return l};return{createTableFill:i,generateContent:t,getFillForCell:function(e,t,r){var s,i=!1,f=l(t),c=e._fills?n(f,e):null;if(void 0!==c&&null!==c?s=c:i=!0,r&&r._fill){d(r._fill,e)<=1&&(s=a(f,r._fill,e))}return void 0!==s&&null!==s||(r&&r._fill&&(f=u(f,r._fill,e,!1)),s=o(f,e)),!s&&r&&r._fill&&(s=r._fill),{fill:f,fillIndex:s,newStyleCreated:i}},getFillForCells:f,generateSingleContent:r}}),n("oxml_xlsx_styles",["utils","oxml_xlsx_font","oxml_xlsx_num_format","oxml_xlsx_border","oxml_xlsx_fill"],function(e,t,r,l,n){var o=function(e){var o='<?xml version="1.0" encoding="utf-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">',a=0;for(o+=r.generateContent(e),o+=t.generateContent(e),o+=n.generateContent(e),o+=l.generateContent(e),o+='<cellStyleXfs count="1"><xf /></cellStyleXfs>',o+='<cellXfs count="'+(parseInt(e.styles.length,10)+1)+'"><xf />',a=0;a<e.styles.length;a++){var i=e.styles[a]._numFormat?' numFmtId="'+e.styles[a]._numFormat+'" ':"",u=e.styles[a]._border?' borderId="'+e.styles[a]._border+'" ':"",f=e.styles[a]._fill?' fillId="'+e.styles[a]._fill+'" ':"";o+='<xf fontId="'+e.styles[a]._font+'" '+i+u+f+" />"}var d="";return e.tableStyles&&e.tableStyles.length&&(d=s(e)),o+="</cellXfs>"+d+"</styleSheet>"},s=function(e){for(var t,r=0,l="",n=0,o=0;o<e.tableStyles.length;o++){var s,i="";r++,n++,t=1,i+=a(e.tableStyles[o]),s='<tableStyleElement dxfId="'+(r-1)+'" type="wholeTable"/>',e.tableStyles[o].evenColumn&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="secondColumnStripe"/>',i+=a(e.tableStyles[o].evenColumn)),e.tableStyles[o].oddColumn&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="firstColumnStripe"/>',i+=a(e.tableStyles[o].oddColumn)),e.tableStyles[o].evenRow&&(r++,t++,
s+='<tableStyleElement dxfId="'+(r-1)+'" type="secondRowStripe"/>',i+=a(e.tableStyles[o].evenRow)),e.tableStyles[o].oddRow&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="firstRowStripe"/>',i+=a(e.tableStyles[o].oddRow)),e.tableStyles[o].firstColumn&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="firstColumn"/>',i+=a(e.tableStyles[o].firstColumn)),e.tableStyles[o].lastColumn&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="lastColumn"/>',i+=a(e.tableStyles[o].lastColumn)),e.tableStyles[o].firstRow&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="headerRow"/>',i+=a(e.tableStyles[o].firstRow)),e.tableStyles[o].lastRow&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="totalRow"/>',i+=a(e.tableStyles[o].lastRow)),e.tableStyles[o].firstRowFirstCell&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="firstHeaderCell"/>',i+=a(e.tableStyles[o].firstRowFirstCell)),e.tableStyles[o].firstRowLastCell&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="lastHeaderCell"/>',i+=a(e.tableStyles[o].firstRowLastCell)),e.tableStyles[o].lastRowFirstCell&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="firstTotalCell"/>',i+=a(e.tableStyles[o].lastRowFirstCell)),e.tableStyles[o].lastRowLastCell&&(r++,t++,s+='<tableStyleElement dxfId="'+(r-1)+'" type="lastTotalCell"/>',i+=a(e.tableStyles[o].lastRowLastCell)),l+='<tableStyle count="'+t+'" name="'+e.tableStyles[o].name+'">'+s+"</tableStyle>"}return l='<tableStyles count="'+n+'">'+l+"</tableStyles>",i='<dxfs count="'+r+'">'+i+"</dxfs>"+l},a=function(e){return dxfString="<dxf>",e.font&&(dxfString+=t.generateSingleContent(e.font)),e.fill&&(dxfString+=n.generateSingleContent(e.fill)),e.border&&(dxfString+=l.generateSingleContent(e.border)),dxfString+="</dxf>",dxfString},i=function(e,t){var r=o(t);e.addFile(r,t.fileName,"workbook")},u=function(e,t,r){var l=e.getLastSheet(),n=parseInt((l.Id||"rId0").replace("rId",""),10)+1;return r.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",{PartName:"/workbook/style"+n+".xml"}),t.addRelation("rId"+n,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","style"+n+".xml"),n},f=function(e,t){for(var r=0;r<e.styles.length;r++)if(void 0!==e.styles[r].cellIndices[t]&&null!==e.styles[r].cellIndices[t])return e.styles[r];return null},d=function(e,t){for(var r=0;r<e.styles.length;r++)if(e.styles[r]._font===t._font&&e.styles[r]._numFormat===t._numFormat)return e.styles[r];return null},c=function(e,o){if(e.cellIndex||e.cellIndices){var s,a,i,u,c,m=!1;if(e.cellIndex){if(s=f(o,e.cellIndex),a=t.getFontForCell(o,e,s),i=r.getNumFormatForCell(o,e,s),u=l.getBorderForCell(o,e,s),c=n.getFillForCell(o,e,s),m=m||a.newStyleCreated||u.newStyleCreated||c.newStyleCreated,s){if(s._font===a.fontIndex&&s._numFormat===i.numFormatIndex&&s._border===u.borderIndex&&s._fill===c.fillIndex)return s;if(1===Object.keys(s.cellIndices).length)return s._font=a.fontIndex,s._numFormat=i.numFormatIndex,s._border=u.borderIndex,s._fill=c.fillIndex,s;delete s.cellIndices[e.cellIndex]}return!m&&(s=d(o,{_font:a.fontIndex,_numFormat:i.numFormatIndex,_border:u.borderIndex,_fill:c.fillIndex}))?(s.cellIndices[e.cellIndex]=Object.keys(s.cellIndices).length,s):(s={_font:a.fontIndex,_numFormat:i.numFormatIndex||!1,_border:u.borderIndex,_fill:c.fillIndex,cellIndices:{}},s.cellIndices[e.cellIndex]=0,s.index=""+(parseInt(o.styles.length,10)+1),o.styles.push(s),s)}if(e.cellIndices){var v;if(a=t.getFontForCells(o,e),i=r.getNumFormatForCells(o,e),u=l.getBorderForCells(o,e),c=n.getFillForCells(o,e),!(m=m||a.newStyleCreated||i.newStyleCreated||u.newStyleCreated||c.newStyleCreated)&&(s=d(o,{_font:a.fontIndex,_numFormat:i.numFormatIndex,_border:u.borderIndex,_fill:c.fillIndex}))){for(v=0;v<e.cellIndices.length;v++){var y=e.cellIndices[v],h=f(o,y);h&&delete h.cellIndices[y],s.cellIndices[y]=Object.keys(s.cellIndices).length}return s}for(s={_font:a.fontIndex,_numFormat:i.numFormatIndex,_border:u.borderIndex,_fill:c.fillIndex,cellIndices:{}},v=0;v<e.cellIndices.length;v++){var y=e.cellIndices[v],h=f(o,y);if(h&&delete h.cellIndices[y],s.cellIndices[y]=Object.keys(s.cellIndices).length,h&&!Object.keys(h.cellIndices).length){for(key in s)h[key]=s[key];return h}}return s.index=""+(parseInt(o.styles.length,10)+1),o.styles.push(s),s}}},m=function(e,t,r,l){l.tableStyles||(l.tableStyles=[]);var n;if(r&&r.tableStyle)for(var o=0;o<l.tableStyles.length;o++)if(r.tableStyle.name===l.tableStyles[o].name){n=l.tableStyles[o];break}var s=v(e,n);if(s.name=t,e.evenColumn?s.evenColumn=v(e.evenColumn,n&&n.evenColumn):n&&n.evenColumn&&(s.evenColumn=n.evenColumn),e.oddColumn?s.oddColumn=v(e.oddColumn,n&&n.oddColumn):n&&n.oddColumn&&(s.oddColumn=n.oddColumn),e.evenRow?s.evenRow=v(e.evenRow,n&&n.evenRow):n&&n.evenRow&&(s.evenRow=n.evenRow),e.oddRow?s.oddRow=v(e.oddRow,n&&n.oddRow):n&&n.oddRow&&(s.oddRow=n.oddRow),e.firstColumn?s.firstColumn=v(e.firstColumn,n&&n.firstColumn):n&&n.firstColumn&&(s.firstColumn=n.firstColumn),e.lastColumn?s.lastColumn=v(e.lastColumn,n&&n.lastColumn):n&&n.lastColumn&&(s.lastColumn=n.lastColumn),e.firstRow?s.firstRow=v(e.firstRow,n&&n.firstRow):n&&n.firstRow&&(s.firstRow=n.firstRow),e.lastRow?s.lastRow=v(e.lastRow,n&&n.lastRow):n&&n.lastRow&&(s.lastRow=n.lastRow),e.firstRowFirstCell?s.firstRowFirstCell=v(e.firstRowFirstCell,n&&n.firstRowFirstCell):n&&n.firstRowFirstCell&&(s.firstRowFirstCell=n.firstRowFirstCell),e.firstRowLastCell?s.firstRowLastCell=v(e.firstRowLastCell,n&&n.firstRowLastCell):n&&n.firstRowLastCell&&(s.firstRowLastCell=n.firstRowLastCell),e.lastRowFirstCell?s.lastRowFirstCell=v(e.lastRowFirstCell,n&&n.lastRowFirstCell):n&&n.lastRowFirstCell&&(s.lastRowFirstCell=n.lastRowFirstCell),e.lastRowLastCell?s.lastRowLastCell=v(e.lastRowLastCell,n&&n.lastRowLastCell):n&&n.lastRowLastCell&&(s.lastRowLastCell=n.lastRowLastCell),n){for(var o=0;o<l.tableStyles.length;o++)if(r.tableStyle.name===l.tableStyles[o].name){l.tableStyles[o]=s;break}}else l.tableStyles.push(s);return s},v=function(e,r){var o={};return o.font=t.createTableFont(e,r?r.font:null),o.fill=n.createTableFill(e,r?r.fill:null),o.border=l.createTableBorder(e),o};return{createStyle:function(t,r,l){var n=u(t,r,l),s={sheetId:n,fileName:"style"+n+".xml",styles:[],_fonts:{},_borders:{},_fills:{},_fontsCount:1,_bordersCount:1,_fillsCount:2},a={bold:!1,italic:!1,underline:!1,size:!1,color:!1,strike:!1,family:!1,name:!1,scheme:!1};s._fonts[e.stringify(a)]=0,s._borders[!1]=0,s._fills[!1]=0;var f={pattern:"gray125",fgColor:!1,bgColor:!1};return s._fills[e.stringify(f)]=1,{_styles:s,generateContent:function(){return o(s)},attach:function(e){i(e,s)},addStyles:function(e){return c(e,s)},addTableStyle:function(e,t,r){return m(e,t,r,s)}}}}}),n("oxml_workbook",["oxml_content_types","oxml_rels","oxml_sheet","oxml_xlsx_styles"],function(e,t,r,l){"use strict";var n=function(e){return e._rels.relations.length?e._rels.relations[e._rels.relations.length-1]:{}},o=function(e,t){var r,l='<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><sheets>';for(r=0;r<e.sheets.length;r++)l+='<sheet name="'+e.sheets[r]._sheet.sheetName+'" sheetId="'+e.sheets[r]._sheet.sheetId+'" r:id="'+e.sheets[r]._sheet.rId+'" />',t&&e.sheets[r].attach(t);return l+="</sheets></workbook>"},s=function(e){if(e._sharedStrings&&Object.keys(e._sharedStrings).length){var t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';for(var r in e._sharedStrings)t+="<si><t>"+r+"</t></si>";return t+="</sst>"}return""},a=function(e,t,l){var o=n(e),s=parseInt((o.Id||"rId0").replace("rId",""),10)+1;t=t||"sheet"+s,e._rels.addRelation("rId"+s,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","sheets/sheet"+s+".xml");var a=r.createSheet(t,s,"rId"+s,e,l);return e.sheets.push(a),e.xlsxContentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",{PartName:"/workbook/sheets/sheet"+s+".xml"}),a},i=function(e,t){t._rels.attach(e);var r=o(t,e);e.addFile(r,"workbook.xml","workbook");var l=s(t);l&&e.addFile(l,"sharedstrings.xml","workbook"),t._styles&&t._styles.attach(e)},u=function(e,t){if(e){if(!t._sharedStrings){t._sharedStrings={},t.xlsxContentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",{PartName:"/workbook/sharedstrings.xml"});var r=n(t),l=parseInt((r.Id||"rId0").replace("rId",""),10)+1;t._rels.addRelation("rId"+l,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings","sharedstrings.xml")}return isNaN(t._sharedStrings[e])&&(t._sharedStrings[e]=Object.keys(t._sharedStrings).length||0),t._sharedStrings[e]}},f=function(e,t){return t._sharedStrings[e]};return{createWorkbook:function(e,r){var s={sheets:[],xlsxContentTypes:e,xlsxRels:r};return s._rels=t.createRelation("workbook.xml.rels","workbook/_rels"),s.addSheet=function(t){return a(s,t,e)},s.generateContent=function(){return o(s)},s.attach=function(e){i(e,s)},s.createSharedString=function(e){return u(e,s)},s.getSharedString=function(e){return f(e,s)},s.createStyles=function(){return s._styles||(s._styles=l.createStyle(s,s._rels,e)),s._styles},s.getLastSheet=function(){return n(s)},s}}}),n("oxml_xlsx",["fileHandler","oxml_content_types","oxml_rels","oxml_workbook"],function(r,l,n,o){"use strict";var s={},a=function(l,n,o){try{var s,a;if("undefined"==typeof window)s=e(),a=t;else if("undefined"==typeof JSZip){if(n)n("Err: JSZip reference not found.");else if("undefined"!=typeof Promise)return new Promise(function(e,t){t("Err: JSZip reference not found.")})}else s=new JSZip;var i=r.createFile(s,a);return o.contentTypes.attach(i),o._rels.attach(i),o.workBook.attach(i),i.saveFile(l,n)}catch(e){if(n)n("Err: Not able to create Workbook.");else if("undefined"!=typeof Promise)return new Promise(function(e,t){t("Err: Not able to create Workbook.")})}},i=function(){var e={};e.contentTypes=l.createContentType(),e.contentTypes.addContentType("Default","application/vnd.openxmlformats-package.relationships+xml",{Extension:"rels"}),e.contentTypes.addContentType("Default","application/xml",{Extension:"xml"}),e.contentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",{PartName:"/workbook/workbook.xml"}),e._rels=n.createRelation(".rels","_rels"),e._rels.addRelation("rId1","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","workbook/workbook.xml"),e.workBook=o.createWorkbook(e.contentTypes,e._rels);var t=function(t,r){return a(t,r,e)};return{_xlsx:e,sheet:e.workBook.addSheet,download:t}};return s.xlsx=i,"undefined"==typeof window||window.oxml||(window.oxml=s),s}),l("oxml_xlsx")});