//Copyright 2012, etc.

/**
 * almond 0.1.2 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

!function(e,t){e.oxml=function(){var e,t,n;return function(r){function o(e,t){var n,r,o,a,s,i,l,u,c,f,p=t&&t.split("/"),h=m.map,d=h&&h["*"]||{};if(e&&"."===e.charAt(0)&&t){for(p=p.slice(0,p.length-1),e=p.concat(e.split("/")),u=0;f=e[u];u++)if("."===f)e.splice(u,1),u-=1;else if(".."===f){if(1===u&&(".."===e[2]||".."===e[0]))return!0;u>0&&(e.splice(u-1,2),u-=2)}e=e.join("/")}if((p||d)&&h){for(n=e.split("/"),u=n.length;u>0;u-=1){if(r=n.slice(0,u).join("/"),p)for(c=p.length;c>0;c-=1)if((o=h[p.slice(0,c).join("/")])&&(o=o[r])){a=o,s=u;break}if(a)break;!i&&d&&d[r]&&(i=d[r],l=u)}!a&&i&&(a=i,s=l),a&&(n.splice(0,s,a),e=n.join("/"))}return e}function a(e,t){return function(){return p.apply(r,g.call(arguments,0).concat([e,t]))}}function s(e){return function(t){return o(t,e)}}function i(e){return function(t){h[e]=t}}function l(e){if(d.hasOwnProperty(e)){var t=d[e];delete d[e],v[e]=!0,f.apply(r,t)}if(!h.hasOwnProperty(e))throw new Error("No "+e);return h[e]}function u(e,t){var n,r,a=e.indexOf("!");return-1!==a?(n=o(e.slice(0,a),t),e=e.slice(a+1),r=l(n),e=r&&r.normalize?r.normalize(e,s(t)):o(e,t)):e=o(e,t),{f:n?n+"!"+e:e,n:e,p:r}}function c(e){return function(){return m&&m.config&&m.config[e]||{}}}var f,p,h={},d={},m={},v={},g=[].slice;f=function(e,t,n,o){var s,f,p,m,g,y,x=[];if(o=o||e,"function"==typeof n){for(t=!t.length&&n.length?["require","exports","module"]:t,y=0;y<t.length;y++)if(g=u(t[y],o),"require"===(p=g.f))x[y]=a(e);else if("exports"===p)x[y]=h[e]={},s=!0;else if("module"===p)f=x[y]={id:e,uri:"",exports:h[e],config:c(e)};else if(h.hasOwnProperty(p)||d.hasOwnProperty(p))x[y]=l(p);else if(g.p)g.p.load(g.n,a(o,!0),i(p),{}),x[y]=h[p];else if(!v[p])throw new Error(e+" missing "+p);m=n.apply(h[e],x),e&&(f&&f.exports!==r&&f.exports!==h[e]?h[e]=f.exports:m===r&&s||(h[e]=m))}else e&&(h[e]=n)},e=t=p=function(e,t,n,o){return"string"==typeof e?l(u(e,t).f):(e.splice||(m=e,t.splice?(e=t,t=n,n=null):e=r),t=t||function(){},o?f(r,e,t,n):setTimeout(function(){f(r,e,t,n)},15),p)},p.config=function(e){return m=e,p},n=function(e,t,n){t.splice||(n=t,t=[]),d[e]=[e,t,n]},n.amd={jQuery:!0}}(),n("build/almond",function(){}),n("fileHandler",[],function(){"use strict";return{createFile:function(){if(window.JSZip){var e=new JSZip,t={_zip:e};return t.addFile=function(t,n,r){var o;r&&(o=e.folder(r)),(o||e).file(n,t)},t.saveFile=function(t){e.generateAsync({type:"blob"}).then(function(e){if(window.saveAs)return saveAs(e,t);var n=window.URL.createObjectURL(e),r=document.createElement("a");r.setAttribute("href",n),r.setAttribute("download",t),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)})},t}}}}),n("oxml_rels",[],function(){"use strict";var e=function(e,t,n,r){r.relations.push({Id:e,Type:t,Target:n})},t=function(e){var t,n='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">';for(t=0;t<e.relations.length;t++)n+='<Relationship Id="'+e.relations[t].Id+'" Type="'+e.relations[t].Type+'" Target="'+e.relations[t].Target+'"/>';return n+="</Relationships>"},n=function(e,n){var r=t(n);e.addFile(r,n.fileName,n.folderName)};return{createRelation:function(r,o){var a={relations:[]};return a.fileName=r,a.folderName=o,a.addRelation=function(t,n,r){e(t,n,r,a)},a.generateContent=function(){return t(a)},a.attach=function(e){return n(e,a)},a}}}),n("oxml_content_types",[],function(){"use strict";var e=function(e){var t,n='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">';for(t=0;t<e.length;t++)n+="<"+e[t].name+' ContentType="'+e[t].contentType+'" ',e[t].Extension&&(n+='Extension="'+e[t].Extension+'" '),e[t].PartName&&(n+='PartName="'+e[t].PartName+'" '),n+="/>\n";return n+="</Types>"},t=function(t,n){var r=e(n);t.addFile(r,"[Content_Types].xml")},n=function(e,t,n,r){var o={name:e,contentType:t};for(var a in n)o[a]=n[a];r.push(o)};return{createContentType:function(){var r=[];return r.addContentType=function(e,t,o){n(e,t,o,r)},r.generateContent=function(){return e(r)},r.attach=function(e){return t(e,r)},r}}}),n("oxml_sheet",[],function(){"use strict";var e=function(e,t){if(!e)return"";if("numeric"===e.type)return'<c r="'+t+'"><v>'+e.value+"</v></c>";if("sharedString"===e.type)return'<c r="'+t+'" t="s"><v>'+e.value+"</v></c>";if("sharedFormula"===e.type)return e.formula?'<c  r="'+t+'"><f t="shared" ref="'+e.range+'" si="'+e.si+'">'+e.formula+"</f></c>":'<c  r="'+t+'"><f t="shared" si="'+e.si+'"></f></c>';if("string"===e.type)return'<c r="'+t+'" t="inlineStr"><is><t>'+e.value+"</t></is></c>";if("formula"===e.type){var n=null!==e.value&&void 0!==e.value?"<v>"+e.value+"</v>":"";return'<c r="'+t+'"><f>'+e.formula+"</f>"+n+"</c>"}},t=function(t){var n=0,r="";if(t.values&&t.values.length)for(n=0;n<t.values.length;n++){if(t.values[n]&&t.values[n].length>0){r+='<row r="'+(n+1)+'">\n';var o=0;for(o=0;o<t.values[n].length;o++){var a=String.fromCharCode(65+o),s=t.values[n][o],i=a+(n+1),l=e(s,i);r+=l}}r+="</row>"}return'<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"><sheetData>'+r+"</sheetData></worksheet>"},n=function(e,n){var r=t(e);n.addFile(r,"sheet"+e.sheetId+".xml","workbook/sheets")},r=function(e,t){if(void 0===e||null===e)return null;if("object"==typeof e){if(!(void 0!==e.value&&null!==e.value||e.formula&&"formula"===e.type))return null;if(e.type)return"sharedString"===e.type?"number"==typeof e.value?{type:e.type,value:e.value}:(e.value=t._workBook.createSharedString(e.value,t._workBook),{type:e.type,value:e.value}):"formula"===e.type?{type:e.type,formula:e.formula,value:e.value}:"numeric"===e.type||"string"===e.type?{type:e.type,value:e.value}:null;e=e.value}return"number"==typeof e?{type:"numeric",value:e}:"string"==typeof e?{type:"string",value:e}:"boolean"==typeof e?{type:"string",value:e+""}:null},o=function(e,t,n){n.values[e-1]||(n.values[e-1]=[]);var o=0;for(o=0;o<t.length;o++){var a=r(t[o],n);a&&(n.values[e-1][o]=a)}},a=function(e,t,n){var o=0;for(o=0;o<t.length;o++){var a=r(t[o],n);n.values[o]||(n.values[o]=[]),a&&(n.values[o][e-1]=a)}},s=function(e,t){var n=0;for(n=0;n<e.length;n++)if(void 0!==e[n]||null!==e[n])if(t.values[n]||(t.values[n]=[]),"object"==typeof e[n]&&e[n].length>=0){var o=0;for(o=0;o<e[n].length;o++){var a=r(e[n][o],t);a&&(t.values[n][o]=a)}}else{var a=r(e[n],t);a&&(t.values[n][0]=a)}},i=function(e,t,n,r){var o;if(n&&t&&r){var a=n.match(/\D+/)[0],s=n.match(/\d+/)[0];if(e._sharedFormula){o=e._sharedFormula[e._sharedFormula.length-1].si+1}else e._sharedFormula=[],o=0;e._sharedFormula.push({si:o,fromCell:n,toCell:r,formula:t});var i=a.toUpperCase().charCodeAt()-65,l=parseInt(s,10);e.values[l-1]||(e.values[l-1]=[]),e.values[l-1][i]={type:"sharedFormula",si:o,formula:t,range:n+":"+r};var u,c;if(r&&(u=r.match(/\D+/)[0],c=r.match(/\d+/)[0]),c===s){var f=u.toUpperCase().charCodeAt()-65;for(i++;i<=f;i++)e.values[l-1][i]={type:"sharedFormula",si:o}}else if(u===a){var p=parseInt(c,10);for(l++;l<=p;l++)e.values[l-1]||(e.values[l-1]=[]),e.values[l-1][i]={type:"sharedFormula",si:o}}return o}};return{createSheet:function(e,r,l,u){var c={sheetName:e,sheetId:r,rId:l,values:[],_workBook:u};return{_sheet:c,generateContent:function(){t(c)},attach:function(e){n(c,e)},updateValuesInRow:function(e,t){!isNaN(e)&&e>=0&&t&&t.length&&o(e,t,c)},updateValuesInColumn:function(e,t){!isNaN(e)&&e>=0&&t&&t.length&&a(e,t,c)},updateValuesInMatrix:function(e){e&&e.length&&s(e,c)},updateSharedFormula:function(e,t,n){return i(c,e,t,n)}}}}}),n("oxml_workbook",["oxml_content_types","oxml_rels","oxml_sheet"],function(e,t,n){"use strict";var r=function(e){return e._rels.relations.length?e._rels.relations[e._rels.relations.length-1]:{}},o=function(e,t){var n,r='<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><sheets>';for(n=0;n<e.sheets.length;n++)r+='<sheet name="'+e.sheets[n]._sheet.sheetName+'" sheetId="'+e.sheets[n]._sheet.sheetId+'" r:id="'+e.sheets[n]._sheet.rId+'" />',t&&e.sheets[n].attach(t);return r+="</sheets></workbook>"},a=function(e){if(e._sharedStrings&&Object.keys(e._sharedStrings).length){var t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';for(var n in e._sharedStrings)t+="<si><t>"+n+"</t></si>";return t+="</sst>"}return""},s=function(e,t){var o=r(e),a=parseInt((o.Id||"rId0").replace("rId",""),10)+1;t=t||"sheet"+a,e._rels.addRelation("rId"+a,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","sheets/sheet"+a+".xml");var s=n.createSheet(t,a,"rId"+a,e);return e.sheets.push(s),e.xlsxContentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",{PartName:"/workbook/sheets/sheet"+a+".xml"}),s},i=function(e,t){t._rels.attach(e);var n=o(t,e);e.addFile(n,"workbook.xml","workbook");var r=a(t);r&&e.addFile(r,"sharedstrings.xml","workbook")},l=function(e,t){if(e){if(!t._sharedStrings){t._sharedStrings={},t.xlsxContentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",{PartName:"/workbook/sharedstrings.xml"});var n=r(t),o=parseInt((n.Id||"rId0").replace("rId",""),10)+1;t._rels.addRelation("rId"+o,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings","sharedstrings.xml")}return isNaN(t._sharedStrings[e])&&(t._sharedStrings[e]=Object.keys(t._sharedStrings).length||0),t._sharedStrings[e]}},u=function(e,t){return t._sharedStrings[e]};return{createWorkbook:function(e,n){var r={sheets:[],xlsxContentTypes:e,xlsxRels:n,createSharedString:l};return r._rels=t.createRelation("workbook.xml.rels","workbook/_rels"),{_workBook:r,addSheet:function(e){return s(r,e)},generateContent:function(){return o(r)},attach:function(e){i(e,r)},createSharedString:function(e){return l(e,r)},getSharedString:function(e){return u(e,r)}}}}}),n("oxml_xlsx",["fileHandler","oxml_content_types","oxml_rels","oxml_workbook"],function(e,t,n,r){"use strict";var o={},a=function(t,n){var r=e.createFile();n.contentTypes.attach(r),n._rels.attach(r),n.workBook.attach(r),r.saveFile(t)},s=function(){var e={};e.contentTypes=t.createContentType(),e.contentTypes.addContentType("Default","application/vnd.openxmlformats-package.relationships+xml",{Extension:"rels"}),e.contentTypes.addContentType("Default","application/xml",{Extension:"xml"}),e.contentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",{PartName:"/workbook/workbook.xml"}),e._rels=n.createRelation(".rels","_rels"),e._rels.addRelation("rId1","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","workbook/workbook.xml"),e.workBook=r.createWorkbook(e.contentTypes,e._rels);var o=function(t){JSZip&&a(t,e)};return{_xlsx:e,addSheet:e.workBook.addSheet,download:o}};return o.createXLSX=s,window.oxml||(window.oxml=o),o}),t("oxml_xlsx")}()}(this);